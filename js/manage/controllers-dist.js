"use strict";angular.module("manage.controllers",["ngCookies","datePicker","ngTouch","ngAnimate","googlechart","ngSanitize","ui.calendar"]).controller("FlowCtrl",["$scope","$http",function(e,t){t.get("/page").success(function(t){e.pages=t}),t.get("/flow").success(function(t){e.currentFlows=t}),e.flows=[],e.addPage=function(t){for(var o=0;o<e.flows.length;o++)if(e.flows[o].title===t.title)return;e.flows.push(t)},e.delete=function(e){t.post("/deletepage",{pageId:e._id}).success(function(){})},e.saveFlow=function(){t.post("/flow",{flows:e.flows}).success(function(){})}}]).controller("FlowDetailCtrl",["$scope","$http","$routeParams","$location","$cookies",function(e,t,o,r,i){e.currentIndex=0,t.get("/flow/"+o.flowId).success(function(t){e.flow=t,e.next=e.flow.pages[e.currentIndex].next,e.back=e.flow.pages[e.currentIndex].back,i.flowId=o.flowId,window.location=t.pages[0].url})}]).controller("noteCtrl",["$scope","$http","$routeParams","$location","$cookies","Note","CompanyApi",function(e,t,o,r,i,n,a){e.post={},a.get("",function(t){e.post.company_ref=t._id,n.get({company_ref:t._id},function(t){t.$resolved&&t._id&&(e.post=t)})}),e.save_note=function(){n.post(e.post,function(t){t.$resolved&&(e.post=t)})}}]).controller("PrintReportAccountChartCtrl",["$scope","$http","$routeParams","$location","$cookies","Accounts",function(e,t,o,r,i,n){o.apartment_id&&n.query({apartment_id:o.apartment_id},function(t){e.account_chart_list=t})}]).controller("FlowAddPageCtrl",["$scope","$http","$routeParams","$location",function(e,t,o,r){e.page={},o.pageId&&""!==o.pageId&&t.get("/page/"+o.pageId).success(function(t){e.page=t}),e.save=function(){t.post("/page",{page:e.page}).success(function(){r.path("/flow")})}}]).controller("CloseAccountantCtrl",["$scope","$http","$routeParams","$location","CompanyApi","Room","TransactionApi",function(e,t,o,r,i,n,a){e.cash=0,e.water=0,e.elect=0,e.room_rate=0,e.furniture_rate=0,e.telephone_fee=0,e.credit=0,e.debit=0,e.credits=0,a.query({month:0,property_id:o.apartment_id,year:2015,transaction_type:2},function(t){if(t.$resolved){e.report_list=t,e.toDay=new Date,e.checkDate=new Date(e.toDay.getFullYear(),e.toDay.getMonth(),e.toDay.getDate());for(var o=0;o<e.report_list.length;o++)e.report_date=new Date(e.report_list[o].date),e.report_date>=e.checkDate&&(console.log(e.report_list[o]),e.report_list[o].water_total=(e.report_list[o].water_meter[0].water_meter-e.report_list[o].water_meter[1].water_meter)*e.report_list[o].room_ref.room_water_extra,e.report_list[o].elect_total=(e.report_list[o].elect_meter[0].elect_meter-e.report_list[o].elect_meter[1].elect_meter)*e.report_list[o].room_ref.room_energy_extra,e.report_list[o].telephone=void 0===e.report_list[o].telephone_fee?0:parseFloat(e.report_list[o].telephone_fee),e.report_list[o].total_sum=parseFloat(e.report_list[o].water_total)+parseFloat(e.report_list[o].elect_total)+parseFloat(e.report_list[o].room_ref.room_rate)+parseFloat(e.report_list[o].room_ref.room_furniture)+parseFloat(e.report_list[o].telephone),"50"===e.report_list[o].transfer_bank&&e.report_list[o].transfer_price?e.cash+=e.report_list[o].transfer_price:"50"===e.report_list[o].transfer_bank&&void 0===e.report_list[o].transfer_price?e.cash+=e.report_list[o].total_sum:e.credit+=e.report_list[o].transfer_bank&&"50"!==e.report_list[o].transfer_bank&&e.report_list[o].transfer_price?e.report_list[o].transfer_price:e.report_list[o].total_sum,"50"===e.report_list[o].transfer_bank_extra&&e.report_list[o].transfer_price_extra?e.cash+=e.report_list[o].transfer_price_extra:"50"===e.report_list[o].transfer_bank_extra&&void 0===e.report_list[o].transfer_price_extra?e.cash+=e.report_list[o].total_sum:e.report_list[o].transfer_price_extra&&"50"!==e.report_list[o].transfer_bank_extra&&(e.credit+=e.report_list[o].transfer_price_extra),e.water+=e.report_list[o].water_total,e.elect+=e.report_list[o].elect_total,e.telephone_fee+=e.report_list[o].telephone,e.room_rate+=e.report_list[o].room_ref.room_rate,e.furniture_rate+=e.report_list[o].room_ref.room_furniture);e.debit=e.water+e.elect+e.telephone_fee+e.room_rate+e.furniture_rate,e.credits=e.cash+e.credit,console.log(e.report_list),e.account_report=[{name:"รายได้ค่าน้ำประปา",value:e.water,account_code:"42011"},{name:"รายได้ค่าไฟฟ้า",value:e.elect,account_code:"42012"},{name:"รายได้ค่าโทรศัพท์",value:e.telephone_fee,account_code:"42013"},{name:"รายได้จากการให้เช่าห้องพัก",value:e.room_rate,account_code:"42008"},{name:"รายได้ค่าเช่าเฟอร์นิเจอร์",value:e.furniture_rate,account_code:"43007"},{name:"เงินสด",value:e.cash,account_code:"11101"},{name:"เงินผ่านธนาคาร",value:e.credit,account_code:"1110401"}],console.log(e.account_report)}})}]).controller("ManageCtrl",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","TransactionApi","ResetDemo",function(e,t,o,r,i,n,a,c){angular.element(document).ready(function(){t.checkpermission(),a.query({stat_type:1},function(){}),e.resetdemo=function(){var e=confirm("คุณต้องการลบ ข้อมูล Demo ออกจากระบบ?");1==e&&c.post({confirm_reset:1},function(){t.checkpermission()})}})}]).controller("ExpensesCtrl",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","ExpendApi","CompanyApi",function(e,t,o,r,i,n,a,c){angular.element(document).ready(function(){t.checkpermission(),e.select_properties={},e.select_building=function(e){n.path("manage_expenses").search("building_id="+e),n.replace()},c.query({property_request:1},function(t){if(t.$resolved&&(e.property_list=t,o.apartment_id))for(var r=0;r<e.property_list.length;r++)o.apartment_id===e.property_list[r]._id&&(e.select_properties=e.property_list[r])})}),e.remove_expenses=function(t){var o=confirm("คุณต้องการลบ ข้อมูลหรือไม่? ");1==o&&a.remove({_id:t},function(t){t.$resolved&&a.query({building_id:e.building_id},function(t){t.$resolved&&(e.expend_list=t)})})},e.select_property=function(e){n.path("manage_expenses").search("apartment_id="+e),n.replace()}}]).controller("AddExpensesCtrl",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","ExpendApi","CompanyApi","Room","Accounts",function(e,t,o,r,i,n,a,c,s,l){angular.element(document).ready(function(){t.checkpermission(),e.room_list=[],e.post={},o.building_id&&(e.building_id=o.building_id,s.query({building_ref:e.building_id},function(t){if(t.$resolved)for(var o=0;o<t.length;o++)e.room_list.push({_id:t[o]._id,room_no:t[o].room_no})})),l.query({apartment_id:o.apartment_id,type:5},function(t){e.expenses_list=t})}),e.insert=function(){e.post.building_ref=o.building_id,a.post(e.post,function(e){e.$resolved&&(n.path("manage_expenses").search("building_id="+o.building_id),n.replace())})},e.select_room=function(){e.post.room_ref=e.room_select._id}}]).controller("ManageDownloadCtrl",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","TransactionApi","CompanyApi",function(e,t,o){angular.element(document).ready(function(){t.checkpermission(),o.building_id&&(e.building_id=o.building_id)})}]).controller("AccountChartDetailItemCtrl",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","TransactionApi","CompanyApi","TransactionItem",function(e,t,o,r,i,n,a,c,s){angular.element(document).ready(function(){t.checkpermission(),o.account_id&&(e.account_id=o.account_id,s.query({account_id:o.account_id},function(t){t&&(e.transaction_item=t)}))})}]).controller("PrintReportCompletePaidBillingCtrl",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","TransactionApi","CompanyApi","InvoiceApi","ServerTime",function(e,t,o,r,i,n,a,c,s,l){angular.element(document).ready(function(){t.checkpermission(),e.inv=[],e.water_total=0,e.elect_total=0,e.income_total=0,e.telephone_total=0,e.room_total=0,e.furniture_total=0,e.movein_total=0,e.movein_room_rate=0,e.movein_furniture=0,o.year&&o.month&&(e.reportdate=new Date(o.year,o.month,1)),void 0!==o.apartment_id?a.query({transaction_type:2,property_id:o.apartment_id,year:o.year,month:o.month},function(t){if(t.$resolved){e.report_list=t;for(var r=0;r<e.report_list.length;r++)e.report_list[r]&&2==e.report_list[r].transaction_type?(e.report_list[r].total_sum=0,e.report_list[r].water_meter&&e.report_list[r].water_meter[0]&&(e.report_list[r].water_total=(e.report_list[r].water_meter[0].water_meter-e.report_list[r].water_meter[1].water_meter)*e.report_list[r].room_ref.room_water_extra,e.report_list[r].total_sum+=(e.report_list[r].water_meter[0].water_meter-e.report_list[r].water_meter[1].water_meter)*e.report_list[r].room_ref.room_water_extra,e.water_total+=void 0===e.report_list[r].water_total?0:e.report_list[r].water_total),e.report_list[r].elect_meter&&e.report_list[r].elect_meter[0]&&(e.report_list[r].elect_total=(e.report_list[r].elect_meter[0].elect_meter-e.report_list[r].elect_meter[1].elect_meter)*e.report_list[r].room_ref.room_energy_extra,e.report_list[r].total_sum+=(e.report_list[r].elect_meter[0].elect_meter-e.report_list[r].elect_meter[1].elect_meter)*e.report_list[r].room_ref.room_energy_extra,e.elect_total+=void 0===e.report_list[r].elect_total?0:e.report_list[r].elect_total),e.report_list[r].room_ref&&e.report_list[r].room_ref.room_rate&&(e.room_total+=parseFloat(e.report_list[r].room_ref.room_rate),e.report_list[r].total_sum+=parseFloat(e.report_list[r].room_ref.room_rate)),e.report_list[r].room_ref&&e.report_list[r].room_ref.room_furniture&&(e.furniture_total+=parseFloat(e.report_list[r].room_ref.room_furniture),e.report_list[r].total_sum+=parseFloat(e.report_list[r].room_ref.room_furniture)),e.report_list[r]&&e.report_list[r].telephone&&(e.telephone_total+=parseFloat(e.report_list[r].telephone.telephone_fee),e.report_list[r].total_sum+=parseFloat(e.report_list[r].telephone.telephone_fee)),e.report_list[r].customer_ref&&(e.report_list[r].name=e.report_list[r].customer_ref.name)):e.report_list[r]&&3==e.report_list[r].transaction_type&&1==e.report_list[r].status&&(e.report_list[r].room_ref&&e.report_list[r].room_ref.room_rate&&(e.movein_room_rate+=parseFloat(e.report_list[r].room_ref.room_rate),e.report_list[r].total_sum+=parseFloat(e.report_list[r].room_ref.room_rate)),e.report_list[r].room_ref&&e.report_list[r].room_ref.room_furniture&&(e.movein_furniture+=parseFloat(e.report_list[r].room_ref.room_furniture),e.report_list[r].total_sum+=parseFloat(e.report_list[r].room_ref.room_furniture)),e.report_list[r].customer_ref&&(e.report_list[r].name=e.report_list[r].customer_ref.name));e.income_total=e.water_total+e.elect_total+e.telephone_total+e.room_total+e.furniture_total,e.movein_total=e.movein_furniture+e.movein_room_rate,console.log(e.furniture_total),console.log(e.income_total),a.query({property_id:o.apartment_id,year:o.year,month:o.month,remain:1},function(t){for(var o=0;o<t.length;o++)e.report_list.push(t[o])})}}):o.transaction_id&&a.get({transaction_id:o.transaction_id},function(t){t.$resolved&&(e.$watch("report_list",function(){}),e.report_list=[t])}),e.$watch("report_list",function(t){if(t){e._invoice=function(t){for(var o=0;o<e.report_list.length;o++)for(var r=0;r<t.length;r++)if(e.report_list[o]._id===t[r].transaction_ref&&2==e.report_list[o].transaction_type)try{e.report_list[o]._inv=t[r],e.report_list[o]._invorder=t[r].running,e.report_list[o]._inv=t[r],e.report_list[o]._invorder=t[r].running}catch(i){console.log(i)}console.log(e.furniture_total),console.log(e.income_total)};for(var o=0;o<e.report_list.length;o++)e.inv.push(e.report_list[o]._id);s.post_query({invoice:e.inv},e._invoice)}})}),l.get("",function(t){e.server_time=t.time})}]).controller("ManageAccountChart",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","TransactionApi","CompanyApi","Accounts",function(e,t,o,r,i,n,a,c,s){angular.element(document).ready(function(){t.checkpermission(),o.building_id&&(e.building_id=o.building_id)}),e.selected=function(e){n.path("/manage_account_chart").search("apartment_id="+e),n.replace()},s.query({apartment_id:o.apartment_id},function(t){t.$resolved&&(e.account_chart=t)}),c.query({property_request:1},function(t){if(t.$resolved&&(e.property_list=t,o.apartment_id))for(var r=0;r<e.property_list.length;r++)o.apartment_id===e.property_list[r]._id&&(e.select_properties=e.property_list[r])})}]).controller("AddAccountChart",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","TransactionApi","CompanyApi","Accounts",function(e,t,o){angular.element(document).ready(function(){t.checkpermission(),e.post={},o.apartment_id&&o.account_type&&(e.post.type=o.account_type,e.post.property_id=o.apartment_id,e.building_id=o.building_id),e.insert=function(){e.post.account_code=e.post.type+""+e.post.prependcode,console.log(e.post)},e.$watch("post.prependcode",function(t){e.post.account_code=e.post.type+""+t,console.log(t)})})}]).controller("EditAccountChart",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","TransactionApi","CompanyApi",function(e,t,o){angular.element(document).ready(function(){t.checkpermission(),e.post={},o.building_id&&(e.building_id=o.building_id)})}]).controller("AccountChartDetailCtrl",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","TransactionApi","CompanyApi","Accounts",function(e,t,o,r,i,n,a,c,s){angular.element(document).ready(function(){t.checkpermission(),e.post={},o.apartment_id&&o.account_type&&(e.apartment_id=o.apartment_id,e.account_type=o.account_type,s.query({apartment_id:o.apartment_id,type:o.account_type},function(t){t.$resolved&&(e.account_list=t)}))})}]).controller("EditAccountChartItem",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","TransactionApi","CompanyApi",function(e,t,o){angular.element(document).ready(function(){t.checkpermission(),e.post={},o.building_id&&(e.building_id=o.building_id)})}]).controller("PrintBankBillPaymentCtrl",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","TransactionApi","CompanyApi",function(e,t,o){angular.element(document).ready(function(){t.checkpermission(),e.post={},o.building_id&&(e.building_id=o.building_id)})}]).controller("AddAccountChartDetailItemCtrl",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","TransactionApi","CompanyApi","TransactionItem",function(e,t,o,r,i,n,a,c,s){angular.element(document).ready(function(){t.checkpermission(),e.select_properties={},e.post={},o.account_id&&(e.post.account_chart_ref=o.account_id),e.insert=function(){void 0===e.post.account_chart_ref?alert("ทำรายการไม่สำเร็จ กรุณาทำรายการใหม่ตั้งแต่ต้น"):s.post(e.post,function(e){e.$resolved&&alert(e.err?e.err:"เพิ่ม "+e.name+" สำเร็จ")})},c.query({property_request:1},function(t){if(t.$resolved&&(e.property_list=t,o.property_id))for(var r=0;r<e.property_list.length;r++)o.property_id===e.property_list[r]._id&&(e.select_properties=e.property_list[r])})})}]).controller("AddEmployeeCompanyCtrl",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","TransactionApi","CompanyApi",function(e,t,o,r,i,n,a,c){angular.element(document).ready(function(){t.checkpermission(),o.building_id&&(e.building_id=o.building_id)}),e.post={},e.search_user=function(){c.query({search_user:e.search_name},function(t){t.$resolved&&(e.user_list=t)})},e.insert=function(){c.put({company_id:o.company_id,user_ref:e.post.owner},function(e){e.$resolved&&(n.path("company_detail").search("company_id="+o.company_id),n.replace())})}}]).controller("ManageCompanyCtrl",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","TransactionApi","CompanyApi",function(e,t,o,r,i,n,a,c){angular.element(document).ready(function(){t.checkpermission()}),c.query("",function(t){t.$resolved&&(e.company_list=t)}),e.del=function(t,o){var r=confirm("คุณต้องการลบ "+o+" ออกจากระบบ");1==r&&c.remove({_id:t},function(t){t.$resolved&&c.query("",function(t){t.$resolved&&(e.company_list=t)})})}}]).controller("CompanyDetailCtrl",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","TransactionApi","CompanyApi",function(e,t,o,r,i,n,a,c){angular.element(document).ready(function(){t.checkpermission()}),c.get({company_id:o.company_id},function(t){t.$resolved&&(e.company=t)})}]).controller("AddCompanyOwnerCtrl",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","TransactionApi","CompanyApi",function(e,t,o,r,i,n,a,c){angular.element(document).ready(function(){t.checkpermission()}),e.post={},e.search_user=function(){c.query({search_user:e.search_name},function(t){t.$resolved&&(e.user_list=t)})},e.insert=function(){c.put({company_id:o.company_id,owner:e.post.owner},function(e){e.$resolved&&(n.path("company_detail").search("company_id="+o.company_id),n.replace())})}}]).controller("EditCompanyCtrl",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","TransactionApi","CompanyApi",function(e,t,o,r,i,n,a,c){angular.element(document).ready(function(){t.checkpermission()}),e.insert=function(){c.put({company_id:o.company_id,company_name:e.post.owner},function(e){e.$resolved&&(n.path("company_detail").search("company_id="+o.company_id),n.replace())})}}]).controller("EditCompanyOwnerCtrl",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","TransactionApi","CompanyApi",function(e,t){angular.element(document).ready(function(){t.checkpermission()})}]).controller("AddCompanyCtrl",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","TransactionApi","CompanyApi",function(e,t,o,r,i,n,a,c){angular.element(document).ready(function(){t.checkpermission()}),e.insert=function(){void 0!==e.post.company_name&&c.post(e.post,function(e){e.$resolved&&void 0===e.err?(n.path("manage_company"),n.replace()):(alert(e.err),n.path("manage_company"),n.replace())})}}]).controller("ManagePhoneCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","CustomerApi","PhoneApi","CompanyApi",function(e,t,o,r,i,n,a,c,s,l,p,_){e.list={},e.list.post={},e.csv_array={},angular.element(document).ready(function(){t.checkpermission()}),e.compare=function(){for(var t=0;t<e.room_list.length;t++)e.room_list[t].post.elect_meter=parseFloat(e.csv_array[e.room_list[t].room_name]);e.$apply()},e.save_all_csv=function(){var t=confirm("คุณต้องการบันทึกค่าน้ำค่าไฟต่าโทรศัพท์ทุกห้องหรือไม่");if(1==t)for(var o=0;o<e.room_list.length;o++)e.insert(e.room_list[o]._id)},e.$watch("csv_array",function(){}),e.upload_csv=function(t){var o=t.files[0];if("text/csv"===o.type){var r=new FileReader;r.onload=function(t){for(var o=t.target.result,r=0;r<o.split(/\n/g).length;r++)void 0!==o.split(/\n/g)[r].split(",")[6]?e.csv_array[o.split(/\n/g)[r].split(",")[0]]=o.split(/\n/g)[r].split(",")[6]:2==o.split(/\n/g)[r].split(",").length&&void 0!==o.split(/\n/g)[r].split(",")[1]&&(e.csv_array[o.split(/\n/g)[r].split(",")[0]]=o.split(/\n/g)[r].split(",")[1]);e.compare()},r.readAsText(o)}else alert("Failed to load file")},e.select={person:{}},s.query({building_ref:r.building_id},function(t){_.query({building_request:1},function(t){for(var o=0;o<t.length;o++)t[o]._id.toString()===r.building_id.toString()&&(e.building=t[o])}),e.room_list=t;for(var o=0;o<e.room_list.length;o++)e.room_list[o].post={},p.query({room_ref:e.room_list[o]._id,limit:2},function(t){for(var o=e.room_list.length-1;o>=0;o--)try{e.room_list[o]._id===t[0].room_ref._id&&(e.room_list[o].before_telephone_fee=t[1],e.room_list[o].after_telephone_fee=t[0],e.toDay=new Date,e.room_date=new Date(t[0].date),e.room_list[o].post.isUptodate=e.toDay.getDate()==e.room_date.getDate()&&e.toDay.getDate()==e.room_date.getDate()?!0:!1)}catch(r){}})}),e.insert=function(t){e.telephone_fee={},e.telephone_fee.room_ref=t;for(var o=e.room_list.length-1;o>=0;o--)e.room_list[o]._id===t&&(e.telephone_fee.telephone_fee=e.room_list[o].post.telephone_fee);p.post(e.telephone_fee,function(o){o.$resolved&&p.query({room_ref:t,limit:2},function(t){for(var o=e.room_list.length-1;o>=0;o--)try{e.room_list[o]._id===t[0].room_ref._id&&(e.room_list[o].before_telephone_fee=t[1],e.room_list[o].after_telephone_fee=t[0],e.toDay=new Date,e.room_date=new Date(t[0].date),e.room_list[o].post.isUptodate=e.toDay.getDate()==e.room_date.getDate()&&e.toDay.getDate()==e.room_date.getDate()?!0:!1)}catch(r){}})})},e.edit_meter=function(t){for(var o=e.room_list.length-1;o>=0;o--)e.room_list[o]._id===t&&(e.edit_meter_value={},e.edit_meter_value.telephone_fee=e.room_list[o].edit.after_telephone_fee.telephone_fee,e.edit_meter_value._id=e.room_list[o].after_telephone_fee._id,p.post(e.edit_meter_value,function(o){if(o.$resolved)for(var r=e.room_list.length-1;r>=0;r--)e.room_list[r]._id===t&&(e.room_list[r].after_telephone_fee.telephone_fee=o.telephone_fee)}))},e.select_building=function(e){n.path("manage_phone").search("building_id="+e),n.replace()}}]).controller("CashierInvoiceCtrl",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","TransactionApi","ReceiptApi",function(e,t,o,r,i,n,a,c){angular.element(document).ready(function(){t.checkpermission(),e.customer_ref={},e.event=0,e.pay_status=0,e.save_payment=function(t){13==t.keyCode&&0==e.pay_status&&(e.pay_status=1,c.post({invoice:e.transaction._id},function(e){e.$resolved&&e._id?window.open("/manager#!/print_report_vat?transaction_id="+e._id,"_blank"):alert("ทำรายการไม่สำเร็จ")}))},void 0!==o.pay_id&&a.get({receipt:o.pay_id},function(t){t.$resolved&&(e.transaction=t,e.amount=t.room_ref.room_rate+t.room_ref.room_furniture+(t.water_meter[0].water_meter-t.water_meter[1].water_meter)*t.room_ref.room_water_extra,e.amount+=(t.elect_meter[0].elect_meter-t.elect_meter[1].elect_meter)*t.room_ref.room_energy_extra,e.customer_ref=t.customer_ref,e.room_no=t.room_ref.room_no)})})}]).controller("ReportAdminCtrl",["$scope","$rootScope","$routeParams","$log","$anchorScroll","$location","TransactionApi","ResetDemo",function(e,t,o,r,i,n,a,c){angular.element(document).ready(function(){a.query({stat_type:1},function(){}),e.chart_txt="รายรับ",e.chart_type="ColumnChart",e.chart_type_text="กราฟ",e.chart_params="building_income",e.change_params=function(t){1==t?(e.chart_params="building_income",e.chart_txt="รายรับ"):2==t&&(e.chart_params="predict_building_income",e.chart_txt="ประมาณการณ์รายรับ"),e.initchart()},e.change_chart=function(){"ColumnChart"===e.chart_type?(e.chart_type="Table",e.chart_type_text="กราฟ"):(e.chart_type="ColumnChart",e.chart_type_text="ตาราง"),e.initchart()},e.resetdemo=function(){var e=confirm("คุณต้องการลบ ข้อมูล Demo ออกจากระบบ?");1==e&&c.post({confirm_reset:1},function(){t.checkpermission()})};var o={};o.cols=[{id:"รายการ",label:"รายการ",type:"string"}],o.rows=[{c:[{v:"ค่าน้ำ"}]},{c:[{v:"ค่าไฟ"}]},{c:[{v:"ค่าโทรศัพท์"}]},{c:[{v:"ค่าห้อง"}]},{c:[{v:"ค่าเฟอร์นิเจอร์"}]},{c:[{v:"รวม"}]}],e.initchart=function(){var r=0,i=0,n=0,a=0,c=0,s=0;o={},o.cols=[{id:"รายการ",label:"รายการ",type:"string"}],o.rows=[{c:[{v:"ค่าน้ำ"}]},{c:[{v:"ค่าไฟ"}]},{c:[{v:"ค่าโทรศัพท์"}]},{c:[{v:"ค่าห้อง"}]},{c:[{v:"ค่าเฟอร์นิเจอร์"}]},{c:[{v:"รวม"}]}];for(var l=0;l<t.building_list.length;l++){o.cols.push({id:t.building_list[l].building,label:t.building_list[l].building,type:"number"});var p=t.building_list[l];!function(t){o.rows[0].c.push({v:t[e.chart_params].water}),o.rows[1].c.push({v:t[e.chart_params].elect}),o.rows[2].c.push({v:t[e.chart_params].telephone}),o.rows[3].c.push({v:t[e.chart_params].room_rate}),o.rows[4].c.push({v:t[e.chart_params].furniture}),o.rows[5].c.push({v:t[e.chart_params].income}),i+=t[e.chart_params].water,n+=t[e.chart_params].elect,a+=t[e.chart_params].telephone,c+=t[e.chart_params].room_rate,s+=t[e.chart_params].furniture,r+=t[e.chart_params].income}(p)}o.cols.push({id:"รวม",label:"รวม",type:"number"}),o.rows[0].c.push({v:i}),o.rows[1].c.push({v:n}),o.rows[2].c.push({v:a}),o.rows[3].c.push({v:c}),o.rows[4].c.push({v:s}),o.rows[5].c.push({v:r});var _={};_.type=e.chart_type,_.cssStyle="height:500px; width:100%;",_.data=o,_.options={title:e.chart_txt+"ประจำเดือน",isStacked:"false",fill:50,displayExactValues:!0,vAxis:{title:e.chart_txt,gridlines:{count:6}},hAxis:{title:"ประเภท"}},_.formatters={},e.chart=_},setTimeout(function(){e.initchart()},3e3)})}]).controller("editBuildingCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Adsservice",function(e,t,o,r,i,n,a,c){angular.element(document).ready(function(){t.checkpermission()}),e.building={},c.get({building_id:r.building_id},function(t){e.building=t}),e.editbuilding=function(){e.building.user_ref?c.post({building:e.building},function(){c.query({user_ref:i.UID},function(e){t.building_list=e,t.initwaiting=1,n.path("manage_building"),n.replace()})}):alert("กรุณา login หรือ หรือเปิดใช้งาน Cookies หากขัดข้องกรุณาติดต่อเจ้าหน้าที่")}}]).controller("editRoomCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","InventoryApi","UtilityApi",function(e,t,o,r,i,n,a,c,s,l,p){angular.element(document).ready(function(){t.checkpermission()}),e.inventory_list=[],e.inventory_room_list=[],e.utility_room_list=[],e.utility_list=[],e.room={},e.room.images=[],e.services=[],s.get({_id:r.room_id},function(t){if(e.room=t,e.room.images||(e.room.images=[]),e.room.utility_list)for(var o=0;o<e.room.utility_list.length;o++)e.utility_room_list.push({utility_name:e.room.utility_list[o]});if(e.room.inventory_list)for(var o=0;o<e.room.inventory_list.length;o++)e.inventory_room_list.push({inventory_name:e.room.inventory_list[o]});e.services=e.room.service}),e.imagesupload=function(t){var o=new FormData;if(t.type.match("image.*"));else{o.append("image",t.files[0]);var r=new XMLHttpRequest;r.upload.onprogress=function(e){var t=e.loaded/e.total*100;document.getElementById("process_bar").style.width=t+"%"},r.onload=function(){200==r.status?(e.room.images.push(r.responseText),e.$apply()):alert("Error! Upload failed")},r.onerror=function(){alert("Error! Upload failed. Can not connect to server.")},r.open("POST","/resizeimage"),r.send(o)}},l.query({building_ref:r.building_id},function(t){t.$resolved&&(e.inventory_list=t)}),p.query({building_ref:r.building_id},function(t){t.$resolved&&(e.utility_list=t)}),e.editroom=function(){if(i.UID){e.room.inventory_list=[];for(var t=0;t<e.inventory_room_list.length;t++)e.room.inventory_list.push(e.inventory_room_list[t].inventory_name._id);e.room.utility_list=[];for(var t=0;t<e.utility_room_list.length;t++)e.room.utility_list.push(e.utility_room_list[t].utility_name._id);e.room.room_rate_daily=parseInt(e.room.room_rate_daily),e.room.service=e.services,s.post({room:e.room},function(e){n.path("/manage_room").search("building_id="+e.building_ref),n.replace()})}else alert("กรุณา login หรือ หรือเปิดใช้งาน Cookies หากขัดข้องกรุณาติดต่อเจ้าหน้าที่")}}]).controller("EditPropertyCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Adsservice","PropertyApi",function(e,t,o,r,i,n,a,c,s,l){e.bank_details=[],angular.element(document).ready(function(){t.checkpermission()}),l.get({_id:r.property_id},function(t){e.post=t,void 0===t.location[0]&&(e.post.location[0]=0),void 0===t.location[1]&&(e.post.location[1]=0),e.post.bank_detail?e.bank_details=e.post.bank_detail:e.post.bank_detail=[]}),e.getlocation=function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){e.post.location[1]=t.coords.latitude,e.post.location[0]=t.coords.longitude}):alert("กรุณาเปิด GPS ด้วยนะ")},e.isDuplicate=function(){Duplicate.query({namespace:e.post.namespace},function(t){if(t.status)e.duplicatestatus=!1;else try{t.data&&t.data._id!==e.up._id.toString()?(e.register.namespace.$error.pattern=!0,e.duplicatestatus=!0):e.duplicatestatus=!1}catch(o){e.duplicatestatus=!0}})},e.logoupload=function(t){var o=new FormData;if(t.type.match("image.*"));else{o.append("image",t.files[0]);var r=new XMLHttpRequest;r.upload.onprogress=function(e){var t=e.loaded/e.total*100;document.getElementById("process_bar").style.width=t+"%"},r.onload=function(){200==r.status?(e.post.logo=r.responseText,e.$apply()):alert("Error! Upload failed")},r.onerror=function(){alert("Error! Upload failed. Can not connect to server.")},r.open("POST","/resizeimage"),r.send(o)}},e.imageheaderupload=function(t){var o=new FormData;if(t.type.match("image.*"));else{o.append("image",t.files[0]);var r=new XMLHttpRequest;r.upload.onprogress=function(e){var t=e.loaded/e.total*100;document.getElementById("process_bar").style.width=t+"%"},r.onload=function(){200==r.status?(e.post.image_header=r.responseText,e.$apply()):alert("Error! Upload failed")},r.onerror=function(){alert("Error! Upload failed. Can not connect to server.")},r.open("POST","/resizeimage"),r.send(o)}},e.imagesupload=function(t){var o=new FormData;if(t.type.match("image.*"));else{o.append("image",t.files[0]);var r=new XMLHttpRequest;r.upload.onprogress=function(e){var t=e.loaded/e.total*100;document.getElementById("process_bar").style.width=t+"%"},r.onload=function(){200==r.status?(e.post.images.push(r.responseText),e.$apply()):alert("Error! Upload failed")},r.onerror=function(){alert("Error! Upload failed. Can not connect to server.")},r.open("POST","/resizeimage"),r.send(o)}},e.editproperty=function(){e.post.bank_detail=e.bank_details,l.post(e.post,function(){n.path("manage_property"),n.replace()})}}]).controller("ConfirmRentCtrl",["$window","$filter","$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","PropertyApi","CustomerApi","TransactionApi",function(e,t,o,r,i,n,a,c,s,l,p,_,d,u){if(angular.element(document).ready(function(){r.checkpermission();var e="example1234";e=e.toUpperCase(),o.codetoupper=e,$("#bar_key").barcode(r.transaction.customer_ref.toUpperCase(),"code39"),$("#bar_key2").barcode(o.codetoupper,"code39")}),o.roomid=n.room_id,o.select={person:{}},o.confirmwaiting=0,o.confirm_submit=function(){o.confirmwaiting=1,delete r.post._id;for(var e=r.building_list.length-1;e>=0;e--)r.building_list[e]._id===r.post.building_ref&&(r.post.property_ref=r.building_list[e].property_ref);r.transaction.transaction_type=1,r.transaction.transaction_step=2,u.post(r.transaction,function(e){e&&e._id?(p.post({confirm:e.room_ref,room_status:1},function(){}),o.confirmwaiting=0,c.path("print_report_booking").search("transaction_id="+e._id),c.replace()):alert("error")})},o.customerquerylist=[],r.select)if(r.select.person){for(var m in r.select.person)r.select.person[m]&&o.customerquerylist.push(m);0===o.customerquerylist.length?(c.path("select_customer"),c.replace()):1===o.customerquerylist.length?d.get({_id:o.customerquerylist[0]},function(e){o.customer_list=[],o.customer_list.push(e)}):d.query({person_list:o.customerquerylist},function(e){o.customer_list=e})}else c.path("select_customer"),c.replace();else c.path("select_customer"),c.replace()}]).controller("ManageBillingCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","CustomerApi","TransactionApi","ReceiptApi","CompanyApi","ServerTime",function(e,t,o,r,i,n,a,c,s,l,p,_,d,u){t.checkpermission(),e.searchinvoice="",e.select={person:{}},e.pay=0,e.bank_post={},e.bank_post.transfer_bank_extra={},e.bank_post.pay_extra=0,e.select_properties={},e.select_properties.title="เลือก",e.customer_ref={},e.event=0,e.pay_status=0,e.$watch("searchinvoice",function(e,t){console.log(e+"  :  "+t)}),u.get("",function(t){e.server_time=t.time}),d.query({property_request:1},function(t){if(t.$resolved)if(e.property_list=t,console.log(t.length),1==t.length)e.select_properties=t[0];else if(t.length>1)if(r.property_id)for(var o=0;o<e.property_list.length;o++)r.property_id===e.property_list[o]._id&&(e.select_properties=e.property_list[o]);else e.select_properties=t[0]}),e.pay_change=function(t){try{e.pay=parseInt(t),e.pay_status=0}catch(o){e.pay=0}},e.save_payment=function(){console.log(e.pay+" : "+e.amount),0==e.pay_status&&e.pay+e.bank_post.pay_extra-e.amount>=0?(e.pay_status=1,_.post({invoice:e.transaction._id,transfer_bank:e.bank_post.transfer_bank.bank_name,transfer_date:e.bank_post.transfer_date,transfer_ref:e.bank_post.transfer_ref,transfer_price_extra:e.bank_post.pay_extra,transfer_bank_extra:e.bank_post.transfer_bank_extra.bank_name,transfer_ref_extra:e.bank_post.transfer_ref_extra,transfer_date_extra:e.bank_post.transfer_date_extra,transfer_price:e.pay},function(t){t.$resolved&&t._id?(window.open("/manager#!/print_report_vat?transaction_id="+t._id,"_self"),e.pay_status=0):alert("ทำรายการไม่สำเร็จ")
})):0==e.pay_status&&e.pay+e.bank_post.pay_extra-e.amount<=0?(alert("กรุณาใส่ยอดเงินให้ถูกต้อง ยังขาดอยู่ "+-1*(e.pay+e.bank_post.pay_extra-e.amount)+" บาท"),e.pay_status=0):console.log(e.pay+e.bank_post.pay_extra-e.amount)},void 0!==r.pay_id?p.get({receipt:r.pay_id},function(t){t.$resolved&&(e.transaction=t,e.ST=new Date(e.server_time),e.PT=new Date(e.transaction.date_death_line),e.amount=t.room_ref.room_rate+t.room_ref.room_furniture+(t.water_meter[0].water_meter-t.water_meter[1].water_meter)*t.room_ref.room_water_extra,e.amount+=(t.elect_meter[0].elect_meter-t.elect_meter[1].elect_meter)*t.room_ref.room_energy_extra,e.amount+=t.telephone.telephone_fee,e.customer_ref=t.customer_ref,e.room_no=t.room_ref.room_no,e.penalty=e.ST>e.PT?(e.ST.getDate()-e.PT.getDate())*e.transaction.property_ref.penalty:0,e.paid=1==e.transaction.status?!0:!1)}):r.tel?p.get({tel:r.tel},function(t){t.$resolved&&(e.transaction=t,e.ST=new Date(e.server_time),e.PT=new Date(e.transaction.date_death_line),e.amount=t.room_ref.room_rate+t.room_ref.room_furniture+(t.water_meter[0].water_meter-t.water_meter[1].water_meter)*t.room_ref.room_water_extra,e.amount+=(t.elect_meter[0].elect_meter-t.elect_meter[1].elect_meter)*t.room_ref.room_energy_extra,e.amount+=t.telephone.telephone_fee,e.customer_ref=t.customer_ref,e.room_no=t.room_ref.room_no,e.penalty=e.ST>e.PT?(e.ST.getDate()-e.PT.getDate())*e.transaction.property_ref.penalty:0,e.paid=1==e.transaction.status?!0:!1)}):r.room&&r.property_id&&p.get({room_no:r.room,apartment_id:r.property_id},function(t){t.$resolved&&(e.transaction=t,e.ST=new Date(e.server_time),e.PT=new Date(e.transaction.date_death_line),e.amount=t.room_ref.room_rate+t.room_ref.room_furniture+(t.water_meter[0].water_meter-t.water_meter[1].water_meter)*t.room_ref.room_water_extra,e.amount+=(t.elect_meter[0].elect_meter-t.elect_meter[1].elect_meter)*t.room_ref.room_energy_extra,e.amount+=t.telephone.telephone_fee,e.customer_ref=t.customer_ref,e.room_no=t.room_ref.room_no,e.penalty=e.ST>e.PT?(e.ST.getDate()-e.PT.getDate())*e.transaction.property_ref.penalty:0,e.paid=1==e.transaction.status?!0:!1)}),e.search_invoice_by_key=function(t,o){console.log(e.searchinvoice),console.log(e.select_properties),13==t.keyCode&&e.searchinvoice.length>18?(n.path("/manage_billing").search("pay_id="+e.searchinvoice+"&property_id="+e.select_properties._id),n.replace()):13==t.keyCode&&!isNaN(e.searchinvoice)&&e.searchinvoice.length<=4||o?(n.path("/manage_billing").search("room="+e.searchinvoice+"&property_id="+e.select_properties._id),n.replace()):(13==t.keyCode&&!isNaN(e.searchinvoice)||o)&&(n.path("/manage_billing").search("tel="+e.searchinvoice+"&property_id="+e.select_properties._id),n.replace())},e.search_receipt_by_key=function(t){13==t.keyCode&&e.searchreceipt.length>18?(n.path("/manage_billing").search("pay_id="+e.searchreceipt+"&property_id="+e.select_properties._id),n.replace()):13==t.keyCode&&!isNaN(e.searchinvoice)&&e.searchreceipt.length<=4?(n.path("/manage_billing").search("room="+e.searchreceipt+"&property_id="+e.select_properties._id),n.replace()):13!=t.keyCode||isNaN(e.searchreceipt)||(n.path("/manage_billing").search("tel="+e.searchreceipt+"&property_id="+e.select_properties._id),n.replace())},e.search_invoice=function(){e.searchinvoice&&(n.path("/print_report").search("pay_id="+e.searchinvoice),n.replace())},e.callreport=function(e){n.path("print_report_booking").search("transaction_id="+e)}}]).controller("ManageDurableCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","InventoryApi","CompanyApi",function(e,t,o,r,i,n,a,c,s){e.buildingid=r.building_id,angular.element(document).ready(function(){t.checkpermission(),e.select_building=function(e){n.path("manage_durable").search("building_id="+e),n.replace()},e.del=function(t,o){var r=confirm("คุณต้องการลบ "+o+" ออกจากระบบ");1==r&&c.remove({_id:t},function(o){if(o.$resolved)for(var r=0;r<e.inventory_list.length;r++)e.inventory_list[r]._id===t&&e.inventory_list.splice(r,1)})},s.query({building_request:1},function(t){for(var o=0;o<t.length;o++)t[o]._id.toString()===r.building_id.toString()&&(e.building=t[o])}),c.query({building_ref:e.buildingid},function(t){t.$resolved&&(e.inventory_list=t)})})}]).controller("AddDurableCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","InventoryApi",function(e,t,o,r,i,n,a,c){e.buildingid=r.building_id,angular.element(document).ready(function(){t.checkpermission(),r.durable_id&&c.get({_id:r.durable_id},function(t){e.post=t}),e.building_id=r.building_id,e.insert=function(){e.post.building_ref=e.building_id,c.post(e.post,function(t){t.$resolved&&n.path("/manage_durable").search("building_id="+e.building_id)})}})}]).controller("ManageEmployeeCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","EmployeeApi","TransactionApi",function(e,t,o,r,i,n,a,c,s,l){e.employee_list=[],l.get(function(t){t.$resolved&&(e.employee_list=t.user_ref)}),e.del=function(t){l.delete({_id:t},function(t){t.$resolved&&l.get(function(t){t.$resolved&&(e.employee_list=t.user_ref)})})}}]).controller("EditDurableCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","InventoryApi",function(e,t,o,r,i,n,a,c){e.buildingid=r.building_id,angular.element(document).ready(function(){t.checkpermission(),r.durable_id&&c.get({_id:r.durable_id},function(t){e.post=t}),e.building_id=r.building_id,e.update=function(){c.post(e.post,function(t){t.$resolved&&n.path("/manage_durable").search("building_id="+e.building_id)})}})}]).controller("ManageUtilityCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","UtilityApi","CompanyApi",function(e,t,o,r,i,n,a,c,s){e.buildingid=r.building_id,angular.element(document).ready(function(){t.checkpermission(),e.select_building=function(e){n.path("manage_utility").search("building_id="+e),n.replace()},e.del=function(t,o){var r=confirm("คุณต้องการลบ "+o+" ออกจากระบบ");1==r&&c.remove({_id:t},function(o){if(o.$resolved)for(var r=0;r<e.utility_list.length;r++)e.utility_list[r]._id===t&&e.utility_list.splice(r,1)})},s.query({building_request:1},function(t){for(var o=0;o<t.length;o++)t[o]._id.toString()===r.building_id.toString()&&(e.building=t[o])}),c.query({building_ref:e.buildingid},function(t){t.$resolved&&(e.utility_list=t)})})}]).controller("ManageStatementCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","TransactionApi","CustomerApi","CreateTransaction",function(e,t,o,r,i,n,a,c,s,l,p){angular.element(document).ready(function(){t.checkpermission()}),p.query({list:""},function(t){e.userpayment=t}),p.get({balance:""},function(t){e.balance=t})}]).controller("PrintReportElectWaterCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","CustomerApi","CreateTransaction","ServerTime",function(e,t,o,r,i,n,a,c,s,l,p,_){angular.element(document).ready(function(){t.checkpermission()}),e.water_total=0,e.elect_total=0,e.water_total_unit=0,e.elect_total_unit=0,e.water_total_vat=0,e.elect_total_vat=0,e.water,s.query({utillity_report:r.apartment_id},function(t){if(t.$resolved){e.report_list=t;for(var o=0;o<e.report_list.length;o++)e.temp_water=e.report_list[o].water_meter,e.temp_elect=e.report_list[o].elect_meter,e.report_list[o].water_total_exclude=(e.temp_water[0].water_meter-e.temp_water[1].water_meter)*e.report_list[o].room_water_extra/1.07,e.report_list[o].elect_total_exclude=(e.temp_elect[0].elect_meter-e.temp_elect[1].elect_meter)*e.report_list[o].room_energy_extra/1.07,e.water_total+=(e.temp_water[0].water_meter-e.temp_water[1].water_meter)*e.report_list[o].room_water_extra,e.elect_total+=(e.temp_elect[0].elect_meter-e.temp_elect[1].elect_meter)*e.report_list[o].room_energy_extra,e.water_total_unit+=e.temp_water[0].water_meter-e.temp_water[1].water_meter,e.elect_total_unit+=e.temp_elect[0].elect_meter-e.temp_elect[1].elect_meter,e.water_total_vat+=(e.temp_water[0].water_meter-e.temp_water[1].water_meter)*e.report_list[o].room_water_extra-(e.temp_water[0].water_meter-e.temp_water[1].water_meter)*e.report_list[o].room_water_extra/1.07,e.elect_total_vat+=(e.temp_elect[0].elect_meter-e.temp_elect[1].elect_meter)*e.report_list[o].room_energy_extra-(e.temp_elect[0].elect_meter-e.temp_elect[1].elect_meter)*e.report_list[o].room_energy_extra/1.07}}),_.get("",function(t){e.server_time=t.time}),e.post={}}]).controller("ManageOrderPaymenyCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","CustomerApi","CreateTransaction","ServerTime",function(e,t,o,r,i,n,a,c,s,l,p,_){angular.element(document).ready(function(){t.checkpermission()}),s.query({remain:r.apartment_id},function(t){t.$resolved&&(e.report_list=t)}),_.get("",function(t){e.server_time=t.time}),e.post={}}]).controller("PrintReportInvoiceCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","CustomerApi","CreateTransaction",function(e,t){angular.element(document).ready(function(){t.checkpermission()}),e.post={}}]).controller("PrintReportIncomeCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","CustomerApi","CreateTransaction",function(e,t){angular.element(document).ready(function(){t.checkpermission()}),e.post={}}]).controller("PrintReportRentedCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","CustomerApi","CreateTransaction","ServerTime",function(e,t,o,r,i,n,a,c,s,l,p,_){angular.element(document).ready(function(){t.checkpermission()}),e.total_coverage=0,s.query({rented_report:r.apartment_id},function(t){if(t.$resolved){e.report_list=t;for(var o=0;o<e.report_list.length;o++)e.report_list[o].customer_ref=void 0===e.report_list[o].customer_ref?{name:"ห้องว่าง",id_card:"ห้องว่าง"}:e.report_list[o].customer_ref,e.report_list[o].coverage&&1==e.report_list[o].coverage_status&&1!==e.report_list[o].transaction_type&&(e.total_coverage+=e.report_list[o].coverage)}}),_.get("",function(t){e.server_time=t.time}),e.post={}}]).controller("PrintReportMoveOutCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","CustomerApi","CreateTransaction","ServerTime",function(e,t,o,r,i,n,a,c,s,l,p,_){angular.element(document).ready(function(){t.checkpermission()}),s.query({moving_out:r.apartment_id},function(t){t.$resolved&&(e.report_list=t)}),_.get("",function(t){e.server_time=t.time}),e.post={}}]).controller("ThankYouCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","CustomerApi","CreateTransaction",function(e,t){angular.element(document).ready(function(){t.checkpermission()}),e.post={}}]).controller("AddEventCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","CustomerApi","CreateTransaction",function(e,t){angular.element(document).ready(function(){t.checkpermission()}),e.post={}}]).controller("ManageCalendarCtrl",["$scope","$rootScope","$log","$compile","$routeParams","$cookies","$location","$anchorScroll","CalendarApi","uiCalendarConfig",function(e,t,o,r,i,n,a,c,s,l){{var p=new Date;p.getDate(),p.getMonth(),p.getFullYear()}e.events=[],e.eventSources=[],e.alertOnEventClick=function(t){e.alertMessage=alert(t.title+" was clicked ")},e.alertOnDrop=function(t,o){e.alertMessage="Event Droped to make dayDelta "+o},e.alertOnResize=function(t,o){e.alertMessage="Event Resized to make dayDelta "+o},e.addRemoveEventSource=function(e,t){var o=0;angular.forEach(e,function(r,i){e[i]===t&&(e.splice(i,1),o=1)}),0===o&&e.push(t)},e.addEvent=function(){e.calendar_object={title:e.title,textColor:e.color,backgroundColor:e.bgcolor,start:e.startDate,end:e.endDate,user_ref:n.UID},s.post(e.calendar_object,function(t){t.$resolved&&e.events.push(e.calendar_object)})},e.remove=function(t){e.events.splice(t,1)},e.changeView=function(e,t){l.calendars[t].fullCalendar("changeView",e)},e.renderCalender=function(e){l.calendars[e]&&l.calendars[e].fullCalendar("render")},e.eventRender=function(t,o){o.attr({tooltip:t.title,"tooltip-append-to-body":!0}),r(o)(e)},e.uiConfig=t.isMobile?{calendar:{height:450,editable:!1,header:{left:"today",center:"",right:"prev,next"},eventLimit:{month:6,"default":!0},defaultView:"basicDay",eventClick:e.alertOnEventClick,eventDrop:e.alertOnDrop,eventResize:e.alertOnResize,eventRender:e.eventRender}}:{calendar:{height:450,editable:!1,header:{left:"title",center:"month,basicWeek,basicDay",right:"today prev,next"},eventLimit:{month:6,"default":!0},monthNames:["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],monthNamesShort:["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],dayNames:["อาทิตย์","จักนทร์","อังคาร","พุธร์","พฤหัสบดี","ศุกร์","เสาร์"],dayNamesShort:["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."],eventClick:e.alertOnEventClick,eventDrop:e.alertOnDrop,eventResize:e.alertOnResize,eventRender:e.eventRender}},angular.element(document).ready(function(){t.checkpermission(),s.query("",function(t){if(t.$resolved)for(var o=0;o<t.length;o++)t[o].start=new Date(t[o].start),e.events.push(t[o])})}),e.eventSources=[e.events],e.post={}}]).controller("TopupCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","$window","$http","CustomerApi","TransactionApi","CreateTransaction",function(e,t,o,r,i,n,a,c,s,l,p,_){angular.element(document).ready(function(){t.checkpermission()}),e.payment={},e.amount=0,e.invoicestat=!1,e.setamount=function(t){e.amount=t},e.send_payment=function(){_.post({amt:e.amount},function(t){t.invoice&&(e.payment.inv=t.invoice,e.invoicenumber=t.invoice,e.invoicestat=!0)})}}]).controller("AddUtilityCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","UtilityApi",function(e,t,o,r,i,n,a,c){angular.element(document).ready(function(){t.checkpermission(),e.building_id=r.building_id,e.insert=function(){e.post.building_ref=e.building_id,c.post(e.post,function(){n.path("manage_utility").search("building_id="+e.building_id)})}})}]).controller("PrintReceiptMonthlyCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","CustomerApi","TransactionApi",function(e,t,o,r,i,n,a,c,s,l,p){angular.element(document).ready(function(){t.checkpermission()}),e.buildingid=r.building_id,e.select_building=function(e){n.path("manage_utility").search("building_id="+e),n.replace()},p.get({transaction_id:r.transaction_id},function(t){e.buildingid=t.building_ref._id,e.post=t,e.pricetostring=$filter("thbToString")(e.post.reserve_price.toString());var o=t._id;o=o.toUpperCase(),e.codetoupper=o,$("#bar_key").barcode(e.codetoupper,"code39")})}]).controller("EditUtilityCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","UtilityApi",function(e,t,o,r,i,n,a,c){angular.element(document).ready(function(){t.checkpermission(),r.utility_id&&c.get({_id:r.utility_id},function(t){e.post=t}),e.building_id=r.building_id,e.update=function(){c.post(e.post,function(t){t.$resolved&&n.path("manage_utility").search("building_id="+e.building_id)})}})}]).controller("MakeRoomCoverageCtrl",["$scope","$filter","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","CustomerApi","TransactionApi",function(e,t,o,r,i,n,a,c,s,l,p,_){angular.element(document).ready(function(){o.checkpermission()}),e.buildingid=i.building_id,e.select_building=function(e){a.path("manage_utility").search("building_id="+e),a.replace()},_.get({transaction_id:i.transaction_id},function(o){e.buildingid=o.building_ref._id,e.post=o,e.pricetostring=t("thbToString")(e.post.reserve_price.toString());var r=o._id;r=r.toUpperCase(),e.codetoupper=r,$("#bar_key").barcode(e.codetoupper,"code39")})}]).controller("PrintRoomCoverageCtrl",["$scope","$filter","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","CustomerApi","TransactionApi",function(e,t,o,r,i,n,a,c,s,l,p,_){angular.element(document).ready(function(){o.checkpermission()}),e.buildingid=i.building_id,e.select_building=function(e){a.path("manage_utility").search("building_id="+e),a.replace()},_.get({transaction_id:i.transaction_id},function(o){e.buildingid=o.building_ref._id,e.post=o,e.pricetostring=t("thbToString")(e.post.reserve_price.toString());var r=o._id;r=r.toUpperCase(),e.codetoupper=r,$("#bar_key").barcode(e.codetoupper,"code39")})}]).controller("MakeRoomChecklist",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","CustomerApi","TransactionApi",function(e,t,o,r,i,n,a,c,s,l,p){e.post=[],e.payment_list=[],e.item=[{name:"ค่ามัดจำ",price:500},{name:"ค่าประกัน",price:1e4},{name:"คาคีย์การ์ด",price:100},{name:"อินเตอร์เน็ต",price:300},{name:'ทีวี 21"',price:100}],e.post.payment_this=[],e.post.date=new Date,angular.element(document).ready(function(){t.checkpermission()}),p.get({transaction_id:r.transaction_id},function(t){e.buildingid=t.building_ref._id,e.post=t,e.pricetostring=$filter("thbToString")(e.post.reserve_price.toString());var o=t._id;o=o.toUpperCase(),e.codetoupper=o,$("#bar_key").barcode(e.codetoupper,"code39")})}]).controller("PrintRoomChecklist",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","CustomerApi","TransactionApi",function(e,t,o,r,i,n,a,c,s,l,p){e.post=[],e.payment_list=[],e.item=[{name:"ค่ามัดจำ",price:500},{name:"ค่าประกัน",price:1e4},{name:"คาคีย์การ์ด",price:100},{name:"อินเตอร์เน็ต",price:300},{name:'ทีวี 21"',price:100}],e.post.payment_this=[],e.post.date=new Date,angular.element(document).ready(function(){t.checkpermission()}),p.get({transaction_id:r.transaction_id},function(t){e.buildingid=t.building_ref._id,e.post=t,e.pricetostring=$filter("thbToString")(e.post.reserve_price.toString());var o=t._id;o=o.toUpperCase(),e.codetoupper=o,$("#bar_key").barcode(e.codetoupper,"code39")})}]).controller("RoomDetailCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","CustomerApi","CalendarApi","ElectApi","WaterApi","TransactionApi","CompanyApi",function(e,t,o,r,i,n,a,c,s,l,p,_,d,u){t.checkpermission(),e.room_id=r.room_id,e.select={person:{}};for(var m=0;13>m;m++)e["water_meter"+m]={},e["elect_meter"+m]={};u.query({room_id:r.room_id},function(t){t.$resolved&&(e.room_transaction=t)}),e.water_query=function(t){t-=1,d.query({meter_room_ref:r.room_id,limit:100,year:2014,month:t},function(o){o.$resolved&&(e["water_meter"+(t+1)]=o)})},e.elect_query=function(t){t-=1,_.query({meter_room_ref:r.room_id,limit:100,year:2014,month:t},function(o){o.$resolved&&(e["elect_meter"+(t+1)]=o)})},e.events=[],d.query({meter_room_ref:r.room_id,limit:100,year:2014,month:1},function(t){t.$resolved&&(e.water_meter=t)}),_.query({meter_room_ref:r.room_id,limit:100,year:2014,month:1},function(t){t.$resolved&&(e.elect_meter=t)}),e.eventSources=[],e.changeView=function(e,t){uiCalendarConfig.calendars[t].fullCalendar("changeView",e)},e.renderCalender=function(e){uiCalendarConfig.calendars[e]&&uiCalendarConfig.calendars[e].fullCalendar("render")},e.eventRender=function(t,o){o.attr({tooltip:t.title,"tooltip-append-to-body":!0}),$compile(o)(e)},e.uiConfig=t.isMobile?{calendar:{height:450,editable:!1,header:{left:"today",center:"",right:"prev,next"},eventLimit:{month:6,"default":!0},defaultView:"basicDay",eventClick:e.alertOnEventClick,eventDrop:e.alertOnDrop,eventResize:e.alertOnResize,eventRender:e.eventRender}}:{calendar:{height:450,editable:!1,header:{left:"title",center:"month,basicWeek,basicDay",right:"today prev,next"},eventLimit:{month:6,"default":!0},monthNames:["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],monthNamesShort:["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],dayNames:["อาทิตย์","จักนทร์","อังคาร","พุธร์","พฤหัสบดี","ศุกร์","เสาร์"],dayNamesShort:["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."],eventClick:e.alertOnEventClick,eventDrop:e.alertOnDrop,eventResize:e.alertOnResize,eventRender:e.eventRender}},e.eventSources=[e.events],u.get({room_renter:r.room_id},function(t){e.renter=t.customer_ref}),s.get({_id:r.room_id},function(t){if(e.room=t,e.room.images||(e.room.images=[]),e.room.utility_list)for(var o=0;o<e.room.utility_list.length;o++)e.utility_room_list.push({utility_name:e.room.utility_list[o]});if(e.room.inventory_list)for(var o=0;o<e.room.inventory_list.length;o++)e.inventory_room_list.push({inventory_name:e.room.inventory_list[o]});e.services=e.room.service})}]).controller("UpdatePaymentCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","CustomerApi","CompanyApi",function(e,t,o,r,i,n,a,c,s){t.checkpermission(),e.select={person:{}},s.query({building_ref:r.building_id},function(t){e.room_list=t,e.waiting=1})}]).controller("ManageWaterCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","CustomerApi","WaterApi","CompanyApi",function(e,t,o,r,i,n,a,c,s,l,p,_){t.checkpermission(),e.csv_array={},e.compare=function(){for(var t=0;t<e.room_list.length;t++)e.room_list[t].post.water_meter=parseFloat(e.csv_array[e.room_list[t].room_name])},e.$watch("csv_array",function(){}),e.save_all_csv=function(){var t=confirm("คุณต้องการบันทึกค่าน้ำค่าไฟต่าโทรศัพท์ทุกห้องหรือไม่");if(1==t)for(var o=0;o<e.room_list.length;o++)e.insert(e.room_list[o]._id)},e.upload_csv=function(t){var o=t.files[0];if("text/csv"===o.type){var r=new FileReader;r.onload=function(t){for(var o=t.target.result,r=0;r<o.split(/\n/g).length;r++)void 0!==o.split(/\n/g)[r].split(",")[6]?e.csv_array[o.split(/\n/g)[r].split(",")[0]]=o.split(/\n/g)[r].split(",")[6]:2==o.split(/\n/g)[r].split(",").length&&void 0!==o.split(/\n/g)[r].split(",")[1]&&(e.csv_array[o.split(/\n/g)[r].split(",")[0]]=o.split(/\n/g)[r].split(",")[1]);e.compare()},r.readAsText(o)}else alert("Failed to load file")},e.select={person:{}},r.building_id&&(_.query({building_request:1},function(t){for(var o=0;o<t.length;o++)t[o]._id.toString()===r.building_id.toString()&&(e.building=t[o])}),s.query({building_ref:r.building_id},function(t){e.room_list=t;for(var o=0;o<e.room_list.length;o++)e.room_list[o].post={water_meter:0},p.query({room_ref:e.room_list[o]._id,limit:2},function(t){for(var o=e.room_list.length-1;o>=0;o--)try{e.room_list[o]._id===t[0].room_ref._id&&(e.room_list[o].before_water_bill=t[1],e.room_list[o].after_water_bill=t[0],e.room_list[o].post.water_meter=t[0].water_meter,e.toDay=new Date,e.room_date=new Date(t[0].date),e.room_list[o].post.isUptodate=e.toDay.getDate()==e.room_date.getDate()&&e.toDay.getDate()==e.room_date.getDate()?!0:!1)}catch(r){}})})),e.insert=function(t,o){e.water={},e.water.room_ref=t;for(var r=e.room_list.length-1;r>=0;r--)e.room_list[r]._id===t&&(e.water.water_meter=e.room_list[r].post.water_meter);p.post(e.water,function(r){r.$resolved&&p.query({room_ref:t,limit:2},function(t){e.room_list[o].before_water_bill=t[1],e.room_list[o].after_water_bill=t[0],e.room_list[o].post.water_meter=t[0].water_meter,e.toDay=new Date,e.room_date=new Date(t[0].date),e.room_list[o].post.isUptodate=e.toDay.getDate()==e.room_date.getDate()&&e.toDay.getDate()==e.room_date.getDate()?!0:!1})})},e.edit_meter=function(t){for(var o=e.room_list.length-1;o>=0;o--)e.room_list[o]._id===t&&(e.edit_meter_value={},e.edit_meter_value.water_meter=e.room_list[o].edit.after_water_bill.water_meter,e.edit_meter_value._id=e.room_list[o].after_water_bill._id,p.post(e.edit_meter_value,function(o){if(o.$resolved)for(var r=e.room_list.length-1;r>=0;r--)e.room_list[r]._id===t&&(e.room_list[r].after_water_bill.water_meter=o.water_meter)}))},e.select_building=function(e){n.path("manage_water").search("building_id="+e),n.replace()}}]).controller("ManageElecCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","CustomerApi","ElectApi","CompanyApi",function(e,t,o,r,i,n,a,c,s,l,p,_){e.list={},e.list.post={},e.csv_array={},e.building_ids=r.building_id,angular.element(document).ready(function(){t.checkpermission()}),e.compare=function(){for(var t=0;t<e.room_list.length;t++)e.room_list[t].post.elect_meter=parseFloat(e.csv_array[e.room_list[t].room_name]);e.$apply()},e.save_all_csv=function(){var t=confirm("คุณต้องการบันทึกค่าน้ำค่าไฟต่าโทรศัพท์ทุกห้องหรือไม่");if(1==t)for(var o=0;o<e.room_list.length;o++)e.insert(e.room_list[o]._id)},e.$watch("csv_array",function(){}),e.upload_csv=function(t){var o=t.files[0];if("text/csv"===o.type){var r=new FileReader;r.onload=function(t){for(var o=t.target.result,r=0;r<o.split(/\n/g).length;r++)void 0!==o.split(/\n/g)[r].split(",")[6]?e.csv_array[o.split(/\n/g)[r].split(",")[0]]=o.split(/\n/g)[r].split(",")[6]:2==o.split(/\n/g)[r].split(",").length&&void 0!==o.split(/\n/g)[r].split(",")[1]&&(e.csv_array[o.split(/\n/g)[r].split(",")[0]]=o.split(/\n/g)[r].split(",")[1]);e.compare()},r.readAsText(o)}else alert("Failed to load file")},r.building_id&&(_.query({building_request:1},function(t){for(var o=0;o<t.length;o++)t[o]._id.toString()===r.building_id.toString()&&(e.building=t[o])}),s.query({building_ref:r.building_id},function(t){e.room_list=t;for(var o=0;o<e.room_list.length;o++)e.room_list[o].post={},p.query({room_ref:e.room_list[o]._id,limit:2},function(t){for(var o=e.room_list.length-1;o>=0;o--)try{e.room_list[o]._id===t[0].room_ref._id&&(e.room_list[o].before_elect_bill=t[1],e.room_list[o].after_elect_bill=t[0],e.room_list[o].post.elect_meter=t[0].elect_meter,e.toDay=new Date,e.room_date=new Date(t[0].date),e.room_list[o].post.isUptodate=e.toDay.getDate()==e.room_date.getDate()&&e.toDay.getDate()==e.room_date.getDate()?!0:!1)}catch(r){}})})),e.insert=function(t,o){e.elect={},e.elect.room_ref=t;for(var r=e.room_list.length-1;r>=0;r--)e.room_list[r]._id===t&&(e.elect.elect_meter=e.room_list[r].post.elect_meter);p.post(e.elect,function(r){r.$resolved&&p.query({room_ref:t,limit:2},function(t){e.room_list[o].before_elect_bill=t[1],e.room_list[o].after_elect_bill=t[0],e.room_list[o].post.elect_meter=t[0].elect_meter,e.toDay=new Date,e.room_date=new Date(t[0].date),e.room_list[o].post.isUptodate=e.toDay.getDate()==e.room_date.getDate()&&e.toDay.getDate()==e.room_date.getDate()?!0:!1})})},e.edit_meter=function(t){for(var o=e.room_list.length-1;o>=0;o--)e.room_list[o]._id===t&&(e.edit_meter_value={},e.edit_meter_value.elect_meter=e.room_list[o].edit.after_elect_bill.elect_meter,e.edit_meter_value._id=e.room_list[o].after_elect_bill._id,p.post(e.edit_meter_value,function(o){if(o.$resolved)for(var r=e.room_list.length-1;r>=0;r--)e.room_list[r]._id===t&&(e.room_list[r].after_elect_bill.elect_meter=o.elect_meter)}))},e.select_building=function(e){n.path("manage_elec").search("building_id="+e),n.replace()}}]).controller("CustomerBillingCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","TransactionApi","CustomerApi",function(e,t,o,r,i,n,a,c,s,l,p){angular.element(document).ready(function(){t.checkpermission()}),e.select={person:{}},void 0!==r.room_id?l.query({room_id:r.room_id},function(t){t&&t.length?l.query({ref_id:t[0]._id},function(o){e.transaction_list=o&&o.length?o:t}):e.transaction_list=t}):void 0!==r.customer_id&&(l.query({customer_id:r.customer_id},function(t){t&&t.length?l.query({ref_id:t[0]._id},function(o){e.transaction_list=o&&o.length?o:t}):e.transaction_list=t}),p.get({_id:r.customer_id},function(t){e.customer_detail=t})),l.query({customer_id:r.customer_id},function(t){t&&t.length?l.query({ref_id:t[0]._id},function(o){e.transaction_list=o&&o.length?o:t}):e.transaction_list=t})}]).controller("AddPropertyCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Adsservice","PropertyApi","Duplicate",function(e,t,o,r,i,n,a,c,s,l,p){angular.element(document).ready(function(){t.checkpermission()}),11==i.Permission?e.post={images:[],location:[],title:"Demo Apartment",address:"12/345 มีนบุรี กรุงเทพมหานคร 10230",contact_email:"demouser@email.com",contact_name:"พนักงาน",contact_mobile:"0860000000",contact_tel:"020000000",contact_fax:"020000000",no_room:"30",price_min:"5000",dailyprice:"400",demo:!0}:(e.post={},e.post.images=[],e.post.location=[]),e.getlocation=function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){e.post.location[1]=t.coords.latitude,e.post.location[0]=t.coords.longitude}):alert("กรุณาเปิด GPS ด้วยนะ")},e.isDuplicate=function(){p.query({namespace:e.post.namespace},function(t){if(t.status)e.duplicatestatus=!1;else try{t.data&&t.data._id!==e.up._id.toString()?(e.register.namespace.$error.pattern=!0,e.duplicatestatus=!0):e.duplicatestatus=!1}catch(o){e.duplicatestatus=!0}})},e.logoupload=function(t){var o=new FormData;if(t.type.match("image.*"));else{o.append("image",t.files[0]);var r=new XMLHttpRequest;r.upload.onprogress=function(e){e.loaded/e.total*100},r.onload=function(){200==r.status?(e.post.logo=r.responseText,e.$apply()):alert("Error! Upload failed")},r.onerror=function(){alert("Error! Upload failed. Can not connect to server.")},r.open("POST","/resizeimage"),r.send(o)}},e.imageheaderupload=function(t){var o=new FormData;if(t.type.match("image.*"));else{o.append("image",t.files[0]);var r=new XMLHttpRequest;r.upload.onprogress=function(e){e.loaded/e.total*100},r.onload=function(){200==r.status?(e.post.image_header=r.responseText,e.$apply()):alert("Error! Upload failed")},r.onerror=function(){alert("Error! Upload failed. Can not connect to server.")},r.open("POST","/resizeimage"),r.send(o)}},e.imagesupload=function(t){var o=new FormData;if(t.type.match("image.*"));else{o.append("image",t.files[0]);var r=new XMLHttpRequest;r.upload.onprogress=function(e){e.loaded/e.total*100},r.onload=function(){200==r.status?(e.post.images.push(r.responseText),e.$apply()):alert("Error! Upload failed")},r.onerror=function(){alert("Error! Upload failed. Can not connect to server.")},r.open("POST","/resizeimage"),r.send(o)}},e.insert=function(){l.post(e.post,function(e){e.$resolved&&(e.err?alert("บันทึกไม่สำเร็จ \n"+e.err):(n.path("manage_property"),n.replace()))})}}]).controller("ReportCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","TransactionApi","CompanyApi","InvoiceApi",function(e,t,o,r,i,n,a,c,s,l,p,_){angular.element(document).ready(function(){t.checkpermission(),e.select_properties={},e.select_properties._id=r.apartemnt_id,e.make_invoice=function(t){var o=confirm("คุณต้องการออกรายงานประจำเดือนหรือไม่ \n ******** คำเตือน กรุณาใส่ค่าน้ำค่าไฟค่าโทรศัพท์ให้ครบทุกห้องก่อนทำการออกรายงาน มิเช่นนั้นข้อมูลอาจผิดพลาดได้ ********");1==o&&(e.newDate=new Date,_.post_array({make_invoice:t},function(o){o.$resolved&&(n.path("print_report").search("property_id="+t+"&year="+e.newDate.getFullYear()+"&month="+e.newDate.getMonth()),n.replace())}))},e.select_building=function(e){n.path("manage_report").search("building_id="+e),n.replace()},e.status_list=[],p.query({property_request:1},function(t){e.property_list=t;for(var o=0;o<e.property_list.length;o++)l.get({check_status:e.property_list[o]._id},function(t){t.$resolved&&e.status_list.push(t)})}),setTimeout(function(){for(var t=0;t<e.property_list.length;t++)for(var o=0;o<e.status_list.length;o++)e.property_list[t]._id===e.status_list[o]._id&&(e.property_list[t].check_status=e.status_list[o].status);e.$apply()},2e3)})}]).controller("SelectCustomerCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","TransactionApi","Room","CustomerApi","CompanyApi",function(e,t,o,r,i,n,a,c,s,l,p){angular.element(document).ready(function(){t.checkpermission()
}),e.post_body={},e.post_body.accompany=[],r.building_id&&(e.post_body.building_ref=r.building_id),void 0!==r.reserve_room_id?e.roomid=r.reserve_room_id:void 0!==r.agreement_room_id&&(e.roomid=r.agreement_room_id),t.select={person:{}},e.next_page=function(){if(void 0!==r.reserve_room_id)n.path("select_rent_type").search("reserve_room_id="+r.reserve_room_id);else if(void 0!==r.agreement_room_id&&t.select.person){e.i=0;for(var o in t.select.person)t.select.person[o]&&(0==e.i?(e.post_body.customer_ref=o,e.post_body.accompany.push(o),e.i++):e.post_body.accompany.push(o));e.post_body.transaction_type=3,c.post(e.post_body,function(e){e.$resolved&&void 0===e.err&&n.path("make_agreement").search("transaction_id="+e._id)})}n.replace()},s.get({get_property:e.roomid},function(t){t&&(e.post_body.room_ref=e.roomid,e.post_body.property_ref=t._id)}),p.get("",function(t){l.query({company_id:t._id},function(t){e.customer_list=t})})}]).controller("SelectRentTypeCtrl",["$scope","$filter","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","CustomerApi","ElectApi","WaterApi","TransactionApi","SendNotification","CalendarApi",function(e,t,o,r,i,n,a,c,s,l,p,_,d,u,m,f){angular.element(document).ready(function(){e.customerquerylist=[],o.checkpermission(),i.building_id&&(e.post_body.building_ref=i.building_id),void 0!==i.reserve_room_id?e.roomid=i.reserve_room_id:void 0!==i.agreement_room_id&&(e.roomid=i.agreement_room_id),o.customer={},o.building={},o.property={},o.transaction={},o.room={},o.post={},o.transaction.reserve_price="0",e.smsconfirm=0;var r="example1234";if(r=r.toUpperCase(),e.codetoupper=r,$("#bar_key").barcode(e.codetoupper,"code39"),$("#bar_key2").barcode(e.codetoupper,"code39"),o.$watch("post.customer_ref",function(){try{for(var t=e.customer_list.length-1;t>=0;t--)e.customer_list[t]._id.toString()===e.post.customer_ref.toString()&&($("#bar_key").barcode(e.customer_list[t]._id,"code39"),o.transaction.customer_ref=e.customer_list[t]._id,o.customer=e.customer_list[t],o.customer.birth_date=new Date(o.customer.birth_date))}catch(r){}}),e.makebooking=function(){o.transaction.accompany=[];for(var t=e.customer_list.length-1;t>=0;t--)o.transaction.accompany.push(e.customer_list[t]._id);o.transaction.reserve_price=o.force_reserve_price,o.transaction.room_ref=e.roomid,o.transaction.user_ref=n.UID,u.post(e.transaction,function(t){t&&(e.smsbody={},e.smsbody.email=o.property.contact_email,e.smsbody.tel=o.property.contact_mobile,e.smsbody.message=o.property.title+" ห้อง "+o.room.room_no+" ถูกจองโดย "+e.customer_list[0].name+" "+e.customer_list[0].last_name,0==e.smsconfirm&&(e.smsconfirm++,m.post(e.smsbody,function(){}),e.calendar_object={title:" ห้อง "+o.room.room_no+" ถูกจอง",textColor:"white",backgroundColor:"#4b98ed",start:Date.now(),user_ref:n.UID},f.post(e.calendar_object,function(){}),e.calendar_object={title:" ห้อง "+o.room.room_no+" นัดย้ายเข้า",textColor:"white",backgroundColor:"#d86a9b",start:o.transaction.move_in_date,user_ref:n.UID},f.post(e.calendar_object,function(){})),o.transaction=t,o.customer=t.customer_ref,o.building=t.building_ref,o.room=t.room_ref,o.property=t.property_ref,l.post({confirm:t.room_ref,room_status:1},function(){}),a.path("print_receipt_booking").search("transaction_id="+t._id),a.replace())})},o.$watch("transaction.reserve_price",function(e){try{o.pricetostring=t("thbToString")(o.transaction.reserve_price),o.force_reserve_price=e}catch(r){}}),l.get({get_property:e.roomid},function(e){e&&(o.property.coverage=isNaN(e.deposit)?0:parseInt(e.deposit),o.property.common_fee_charge=isNaN(e.utility)?0:parseInt(e.utility),o.property.furniture=isNaN(e.room_furniture)?0:parseInt(e.room_furniture),o.property.car_park_fee=isNaN(e.parking)?0:parseInt(e.parking),o.property.internet_fee=isNaN(e.net_bill)?0:parseInt(e.net_bill),o.property.title=e.title,o.property.contact_mobile=e.contact_mobile,o.property.contact_tel=e.contact_tel,o.property.contact_email=e.contact_email,o.property.contact_fax=e.contact_fax,o.property.address=e.address,o.property.property_ref=e._id,o.property.deposit=isNaN(e.deposit)||""===e.deposit?0:parseInt(e.deposit),o.property.price_min=isNaN(e.price_min)||""===e.price_min?0:parseInt(e.price_min))}),l.get({_id:i.reserve_room_id},function(e){o.room.room_no=e.room_no,o.room.room_rate=isNaN(e.room_rate)?0:parseInt(e.room_rate);for(var t=o.building_list.length-1;t>=0;t--)o.building_list[t]._id===e.building_ref._id&&(o.transaction.building_ref=o.building_list[t]._id,o.transaction.property_ref=void 0===o.building_list[t].property_ref._id?o.building_list[t].property_ref:o.building_list[t].property_ref._id,o.building.building=o.building_list[t].building,o.building.building_no=o.building_list[t].building_no,o.building.building_ref=o.building_list[t]._id,o.building.property_ref=void 0===o.building_list[t].property_ref._id?o.building_list[t].property_ref:o.building_list[t].property_ref._id)}),e.setpost=function(){o.transaction.accompany=[];for(var t=e.customer_list.length-1;t>=0;t--)o.transaction.accompany.push(e.customer_list[t]._id);o.transaction.reserve_price=o.force_reserve_price,o.transaction.room_ref=e.roomid,o.transaction.user_ref=n.UID},o.select)if(o.select.person){for(var c in o.select.person)o.select.person[c]&&e.customerquerylist.push(c);0===e.customerquerylist.length?(a.path("select_customer"),a.replace()):1===e.customerquerylist.length?p.get({_id:e.customerquerylist[0]},function(t){e.customer_list=[],e.customer_list.push(t),o.transaction.customer_ref=e.customer_list[0]._id,o.customer=e.customer_list[0],o.customer.birth_date=new Date(o.customer.birth_date)}):p.query({person_list:e.customerquerylist},function(t){e.customer_list=t,o.transaction.customer_ref=e.customer_list[0]._id,o.customer=e.customer_list[0],o.customer.birth_date=new Date(o.customer.birth_date)})}else a.path("select_customer"),a.replace();else a.path("select_customer"),a.replace();o.transaction.date=new Date,o.transaction.move_in_date=new Date})}]).controller("FormPersonCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$http","$location","$anchorScroll","CustomerApi","Room",function(e,t,o,r,i,n,a,c,s){angular.element(document).ready(function(){t.checkpermission()}),e.post={},e.getcontent=function(){e.array_person=e.person_area.split("!"),e.post.id_card=parseInt(e.array_person[0]),e.post.birth_date=new Date(e.array_person[1].split("/")[2]-543,e.array_person[1].split("/")[1]-1,e.array_person[1].split("/")[0]),e.post.prefix=e.array_person[3],e.post.name=e.array_person[4],e.post.last_name=e.array_person[5],e.post.id_card_create=new Date(e.array_person[6].split("/")[2]-543,e.array_person[6].split("/")[1]-1,e.array_person[6].split("/")[0]),e.post.id_card_expiry=new Date(e.array_person[7].split("/")[2]-543,e.array_person[7].split("/")[1]-1,e.array_person[7].split("/")[0]),e.post.address_no=e.array_person[8],e.post.address_moo=" "===e.array_person[9]?"-":e.array_person[9],e.post.address_road=e.array_person[11],e.post.address_tumbol=e.array_person[12],e.post.address_aumphur=e.array_person[13],e.post.address_province=e.array_person[14]},e.insert=function(){CompanyApi.get("",function(t){t&&t.err?alert(t.err):(e.post.parent=i.UID,e.post.company_ref=t._id,s.post(e.post,function(){a.path("select_customer").search("room_id="+r.room_id),a.replace()}))})};var l=new FormData;e.idcarduploadfront=function(t){if(l=new FormData,t.type.match("image.*"));else{l.append("image",t.files[0]);var o=new XMLHttpRequest;o.upload.onprogress=function(e){e.loaded/e.total*100},o.onload=function(){200==o.status?e.post.id_card_pic_front=o.responseText:alert("Error! Upload failed")},o.onerror=function(){alert("Error! Upload failed. Can not connect to server.")},o.open("POST","/idcard"),o.send(l)}},e.idcarduploadback=function(t){if(l=new FormData,t.type.match("image.*"));else{l.append("image",t.files[0]);var o=new XMLHttpRequest;o.upload.onprogress=function(e){e.loaded/e.total*100},o.onload=function(){200==o.status?e.post.id_card_pic_back=o.responseText:alert("Error! Upload failed")},o.onerror=function(){alert("Error! Upload failed. Can not connect to server.")},o.open("POST","/idcard"),o.send(l)}}}]).controller("PersonCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$http","$location","$anchorScroll","CustomerApi","Room","CompanyApi",function(e,t,o,r,i,n,a,c,s,l,p){function _(e){var t;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var o=e.split(",")[0].split(":")[1].split(";")[0],r=new Uint8Array(t.length),i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return new Blob([r],{type:o})}angular.element(document).ready(function(){t.checkpermission()}),e.post={},e.getcontent=function(){e.array_person=e.person_area.split("!"),e.post.id_card=parseInt(e.array_person[0]),e.post.birth_date=new Date(e.array_person[1].split("/")[2]-543,e.array_person[1].split("/")[1]-1,e.array_person[1].split("/")[0]),e.post.prefix=e.array_person[3],e.post.name=e.array_person[4],e.post.last_name=e.array_person[5],e.post.id_card_create=new Date(e.array_person[6].split("/")[2]-543,e.array_person[6].split("/")[1]-1,e.array_person[6].split("/")[0]),e.post.id_card_expiry=new Date(e.array_person[7].split("/")[2]-543,e.array_person[7].split("/")[1]-1,e.array_person[7].split("/")[0]),e.post.address_no=e.array_person[8],e.post.address_moo=" "===e.array_person[9]?"-":e.array_person[9],e.post.address_road=e.array_person[11],e.post.address_tumbol=e.array_person[12],e.post.address_aumphur=e.array_person[13],e.post.address_province=e.array_person[14]},e.callcamera=function(){if(!t.isMobile){var o=document.getElementById("canvas"),r=o.getContext("2d"),i=document.getElementById("video"),n={video:!0},a=function(){};navigator.getUserMedia?navigator.getUserMedia(n,function(e){i.src=e,i.play()},a):navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(n,function(e){i.src=window.webkitURL.createObjectURL(e),i.play()},a):navigator.mozGetUserMedia&&navigator.mozGetUserMedia(n,function(e){i.src=window.URL.createObjectURL(e),i.play()},a),document.getElementById("snap").addEventListener("click",function(){r.drawImage(i,0,0,640,480);var t=o.toDataURL("image/png"),n=_(t),a=new FormData;a.append("image",n);var c=new XMLHttpRequest;c.upload.onprogress=function(e){e.loaded/e.total*100},c.onload=function(){200==c.status?e.post.id_card_pic_front=c.responseText:alert("Error! Upload failed")},c.onerror=function(){alert("Error! Upload failed. Can not connect to server.")},c.open("POST","/idcard"),c.send(a)})}},e.insert=function(){p.get("",function(t){t&&t.err?alert(t.err):(e.post.parent=i.UID,e.post.company_ref=t._id,s.post(e.post,function(){a.path("manage_customer"),a.replace()}))})};var d=new FormData;e.idcarduploadfront=function(t){if(d=new FormData,t.type.match("image.*"));else{d.append("image",t.files[0]);var o=new XMLHttpRequest;o.upload.onprogress=function(e){e.loaded/e.total*100},o.onload=function(){200==o.status?e.post.id_card_pic_front=o.responseText:alert("Error! Upload failed")},o.onerror=function(){alert("Error! Upload failed. Can not connect to server.")},o.open("POST","/idcard"),o.send(d)}},e.idcarduploadback=function(t){if(d=new FormData,t.type.match("image.*"));else{d.append("image",t.files[0]);var o=new XMLHttpRequest;o.upload.onprogress=function(e){e.loaded/e.total*100},o.onload=function(){200==o.status?e.post.id_card_pic_back=o.responseText:alert("Error! Upload failed")},o.onerror=function(){alert("Error! Upload failed. Can not connect to server.")},o.open("POST","/idcard"),o.send(d)}}}]).controller("AddEmployeeCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$http","$location","$anchorScroll","EmployeeApi","Room","CompanyApi",function(e,t,o,r,i,n,a,c,s,l,p){function _(e){var t;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var o=e.split(",")[0].split(":")[1].split(";")[0],r=new Uint8Array(t.length),i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return new Blob([r],{type:o})}angular.element(document).ready(function(){t.checkpermission()}),e.post={},e.getcontent=function(){e.array_person=e.person_area.split("!"),e.post.employee_id_card=parseInt(e.array_person[0]),e.post.employee_birth_date=new Date(e.array_person[1].split("/")[2]-543,e.array_person[1].split("/")[1]-1,e.array_person[1].split("/")[0]),e.post.employee_prefix=e.array_person[3],e.post.employee_name=e.array_person[4],e.post.employee_last_name=e.array_person[5],e.post.employee_id_card_create=new Date(e.array_person[6].split("/")[2]-543,e.array_person[6].split("/")[1]-1,e.array_person[6].split("/")[0]),e.post.employee_id_card_expiry=new Date(e.array_person[7].split("/")[2]-543,e.array_person[7].split("/")[1]-1,e.array_person[7].split("/")[0]),e.post.employee_address_no=e.array_person[8],e.post.employee_address_moo=" "===e.array_person[9]?"-":e.array_person[9],e.post.employee_address_road=e.array_person[11],e.post.employee_address_tumbol=e.array_person[12],e.post.employee_address_aumphur=e.array_person[13],e.post.employee_address_province=e.array_person[14]},e.callcamera=function(){if(!t.isMobile){var o=document.getElementById("canvas"),r=o.getContext("2d"),i=document.getElementById("video"),n={video:!0},a=function(){};navigator.getUserMedia?navigator.getUserMedia(n,function(e){i.src=e,i.play()},a):navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(n,function(e){i.src=window.webkitURL.createObjectURL(e),i.play()},a):navigator.mozGetUserMedia&&navigator.mozGetUserMedia(n,function(e){i.src=window.URL.createObjectURL(e),i.play()},a),document.getElementById("snap").addEventListener("click",function(){r.drawImage(i,0,0,640,480);var t=o.toDataURL("image/png"),n=_(t),a=new FormData;a.append("image",n);var c=new XMLHttpRequest;c.upload.onprogress=function(e){e.loaded/e.total*100},c.onload=function(){200==c.status?e.post.id_card_pic_front=c.responseText:alert("Error! Upload failed")},c.onerror=function(){alert("Error! Upload failed. Can not connect to server.")},c.open("POST","/idcard"),c.send(a)})}},e.insert=function(){e.post.parent=i.UID,e.post.permission=8,p.get("",function(t){t.$resolved&&(e.post.company_ref=t._id,s.post(e.post,function(){a.path("manage_employee"),a.replace()}))})};var d=new FormData;e.idcarduploadfront=function(t){if(d=new FormData,t.type.match("image.*"));else{d.append("image",t.files[0]);var o=new XMLHttpRequest;o.upload.onprogress=function(e){e.loaded/e.total*100},o.onload=function(){200==o.status?e.post.id_card_pic_front=o.responseText:alert("Error! Upload failed")},o.onerror=function(){alert("Error! Upload failed. Can not connect to server.")},o.open("POST","/idcard"),o.send(d)}},e.idcarduploadback=function(t){if(d=new FormData,t.type.match("image.*"));else{d.append("image",t.files[0]);var o=new XMLHttpRequest;o.upload.onprogress=function(e){e.loaded/e.total*100},o.onload=function(){200==o.status?e.post.id_card_pic_back=o.responseText:alert("Error! Upload failed")},o.onerror=function(){alert("Error! Upload failed. Can not connect to server.")},o.open("POST","/idcard"),o.send(d)}}}]).controller("EditPersonCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","CustomerApi","Room",function(e,t,o,r,i,n,a,c){angular.element(document).ready(function(){t.checkpermission()}),c.get({_id:r.person_id},function(t){e.post=t,e.post.birth_date=new Date(t.birth_date),e.post.id_card_create=new Date(t.id_card_create),e.post.id_card_expiry=new Date(t.id_card_expiry)}),e.update=function(){c.post(e.post,function(){n.path("manage_customer"),n.replace()})}}]).controller("EditEmployeeCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","EmployeeApi","CompanyApi","Menu",function(e,t,o,r,i,n,a,c,s,l){angular.element(document).ready(function(){t.checkpermission()}),e.apartment_list=[],e.select_property=function(t){-1==e.post.employee_property_ref.indexOf(t)?e.post.employee_property_ref.push(t.toString()):e.post.employee_property_ref.splice(e.post.employee_property_ref.indexOf(t),1)},s.query({property_request:1},function(t){if(t.$resolved){e.property_list=t;for(var o=e.property_list.length-1;o>=0;o--)e.temp={},e.temp._id=e.property_list[o]._id,e.temp.title=e.property_list[o].title,e.temp.select=!0,e.apartment_list.push(e.temp);c.get({employee_id:r.employee_id},function(t){for(var o=e.apartment_list.length-1;o>=0;o--)e.apartment_list[o].select=-1!=t.employee_property_ref.indexOf(e.apartment_list[o]._id)?!0:!1;e.post=t,e.post.employee_birth_date=new Date(t.employee_birth_date),e.post.employee_id_card_create=new Date(t.employee_id_card_create),e.post.employee_id_card_expiry=new Date(t.employee_id_card_expiry)})}}),l.get("",function(t){t.$resolved&&(e.menu_list=t.menu)}),e.insert=function(){c.post(e.post,function(){n.path("manage_employee"),n.replace()})}}]).controller("PrintReportNoVatCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","TransactionApi","InvoiceApi",function(e,t,o,r,i,n,a,c,s,l,p){angular.element(document).ready(function(){t.checkpermission(),e.inv=[],void 0!==r.property_id?l.query({property_id:r.property_id,year:r.year,month:r.month},function(t){t.$resolved&&(e.report_list=t)}):r.transaction_id&&l.get({transaction_id:r.transaction_id},function(t){t.$resolved&&(e.$watch("report_list",function(){}),e.report_list=[t])}),e.$watch("report_list",function(t){if(t){e._invoice=function(t){for(var o=0;o<e.report_list.length;o++)for(var r=0;r<t.length;r++)e.report_list[o]._id===t[r].transaction_ref&&(e.report_list[o]._inv=t[r],e.report_list[o]._invorder=t[r].running)};for(var o=0;o<e.report_list.length;o++)e.inv.push(e.report_list[o]._id);p.post_query({invoice:e.inv},e._invoice)}})})}]).controller("PrintReportCompleteBillCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","TransactionApi","ServerTime","InvoiceApi",function(e,t,o,r,i,n,a,c,s,l,p,_){angular.element(document).ready(function(){t.checkpermission()}),e.water=0,e.elect=0,e.room_rate=0,e.furniture_rate=0,e.telephone_fee=0,e.total=0,e.inv=[],l.query({transaction_type:2,month:r.month,year:r.year,property_id:r.apartment_id},function(t){if(t.$resolved){e.report_list=t,e._invoice=function(t){for(var o=0;o<e.report_list.length;o++)for(var r=0;r<t.length;r++)if(e.report_list[o]._id===t[r].transaction_ref)try{e.report_list[o]._inv=t[r],e.report_list[o]._invorder=t[r].running,e.report_list[o]._inv=t[r],e.report_list[o]._invorder=t[r].running,e.report_list[o].water_total=(e.report_list[o].water_meter[0].water_meter-e.report_list[o].water_meter[1].water_meter)*e.report_list[o].room_ref.room_water_extra,e.water+=e.report_list[o].water_total,e.report_list[o].elect_total=(e.report_list[o].elect_meter[0].elect_meter-e.report_list[o].elect_meter[1].elect_meter)*e.report_list[o].room_ref.room_energy_extra,e.elect+=e.report_list[o].elect_total,e.room_rate+=parseFloat(e.report_list[o].room_ref.room_rate),e.report_list[o].telephone&&(e.telephone_fee+=parseFloat(e.report_list[o].telephone.telephone_fee),e.total+=parseFloat(e.report_list[o].telephone.telephone_fee)),e.report_list[o].room_ref.room_furniture?(e.report_list[o].total_sum=parseFloat(e.report_list[o].water_total)+parseFloat(e.report_list[o].elect_total)+parseFloat(e.report_list[o].room_ref.room_rate)+parseFloat(e.report_list[o].room_ref.room_furniture),e.furniture_rate+=parseFloat(e.report_list[o].room_ref.room_furniture)):e.report_list[o].total_sum=parseFloat(e.report_list[o].water_total)+parseFloat(e.report_list[o].elect_total)+parseFloat(e.report_list[o].room_ref.room_rate),e.total+=e.report_list[o].total_sum,e.report_list[o].name=e.report_list[o].customer_ref.name}catch(i){e.report_list.splice(o,1)}};for(var o=0;o<e.report_list.length;o++)e.inv.push(e.report_list[o]._id);_.post_query({invoice:e.inv},e._invoice)}}),p.get("",function(t){e.server_time=t.time})}]).controller("PrintReportUnCompleteBillCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","InvoiceApi","ServerTime",function(e,t,o,r,i,n,a,c,s,l,p){angular.element(document).ready(function(){t.checkpermission()}),e.inv=[],e.$watch("report_list",function(t){if(t){e._invoice=function(t){for(var o=0;o<e.report_list.length;o++)for(var r=0;r<t.length;r++)e.report_list[o]._id===t[r].transaction_ref&&(e.report_list[o]._inv=t[r],e.report_list[o]._invorder=t[r].running,e.report_list[o].water_total=(e.report_list[o].water_meter[0].water_meter-e.report_list[o].water_meter[1].water_meter)*e.report_list[o].room_ref.room_water_extra,e.report_list[o].elect_total=(e.report_list[o].elect_meter[0].elect_meter-e.report_list[o].elect_meter[1].elect_meter)*e.report_list[o].room_ref.room_energy_extra,e.report_list[o].total_sum=parseFloat(e.report_list[o].water_total)+parseFloat(e.report_list[o].elect_total)+parseFloat(e.report_list[o].room_ref.room_rate)+parseFloat(e.report_list[o].room_ref.room_furniture),e.report_list[o].name=e.report_list[o].customer_ref.name)};for(var o=0;o<e.report_list.length;o++)e.inv.push(e.report_list[o]._id);l.post_query({invoice:e.inv},e._invoice)}}),s.query({remain:r.apartment_id},function(t){t.$resolved&&(e.report_list=t)}),p.get("",function(t){e.server_time=t.time})}]).controller("PrintReportVatCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","TransactionApi","InvoiceApi","ServerTime",function(e,t,o,r,i,n,a,c,s,l,p,_){angular.element(document).ready(function(){t.checkpermission(),e.inv=[],void 0!==r.property_id?l.query({property_id:r.property_id,transaction_type:4,year:r.year,month:r.month},function(t){t.$resolved&&(e.report_list=t)}):r.transaction_id&&l.get({transaction_id:r.transaction_id},function(t){t.$resolved&&(e.$watch("report_list",function(){}),e.report_list=[t])}),e.$watch("report_list",function(t){if(t){e._invoice=function(t){for(var o=0;o<e.report_list.length;o++)for(var r=0;r<t.length;r++)e.report_list[o]._id===t[r].transaction_ref&&(e.report_list[o]._inv=t[r],e.report_list[o]._invorder=t[r].running)};for(var o=0;o<e.report_list.length;o++)e.inv.push(e.report_list[o]._id);p.post_query({invoice:e.inv},e._invoice)}})}),_.get("",function(t){e.server_time=t.time})}]).controller("PrintReportCustomVatCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","TransactionApi",function(e,t){e.item_list=[],angular.element(document).ready(function(){t.checkpermission()}),e.items=[{name:"ค่ามัดจำ",price:500},{name:"ค่าประกัน",price:1e4},{name:"คาคีย์การ์ด",price:100},{name:"อินเตอร์เน็ต",price:300},{name:'ทีวี 21"',price:100}]}]).controller("PrintReportCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","TransactionApi","InvoiceApi",function(e,t,o,r,i,n,a,c,s,l,p){angular.element(document).ready(function(){t.checkpermission(),e.inv=[],e.month=(new Date).getMonth()+1,void 0!==r.property_id?l.query({property_id:r.property_id,transaction_type:4,year:r.year,month:r.month},function(t){t.$resolved&&(e.billing_list=t)}):r.transaction_id?l.get({transaction_id:r.transaction_id},function(t){t.$resolved&&(e.$watch("billing_list",function(){}),e.billing_list=[t],setTimeout(function(){var t=e.billing_list[0]._id;t=t.toUpperCase(),e.codetoupper=t,e.barid="#bar_key",$(e.barid).barcode(e.codetoupper,"code39")},300))}):r.tel?l.get({tel:r.tel},function(t){t.$resolved&&(e.$watch("billing_list",function(){}),e.billing_list=[t],setTimeout(function(){if(e.billing_list&&e.billing_list[0]._id){var t=e.billing_list[0]._id;t=t.toUpperCase(),e.codetoupper=t,e.barid="#bar_key0",$(e.barid).barcode(e.codetoupper,"code39")}},200))}):r.room&&l.get({room_no:r.transaction_id},function(t){t.$resolved&&(e.$watch("billing_list",function(){}),e.billing_list=[t],setTimeout(function(){var t=e.billing_list[0]._id;t=t.toUpperCase(),e.codetoupper=t,e.barid="#bar_key0",$(e.barid).barcode(e.codetoupper,"code39")},200))}),e.$watch("billing_list",function(t){if(t){setTimeout(function(){for(var t=0;t<e.billing_list.length;t++)if(e.billing_list&&e.billing_list[0]._id){var o=e.billing_list[t]._id;o=o.toUpperCase(),e.codetoupper=o,e.barid="#bar_key"+e.billing_list[t].room_no,$(e.barid).barcode(e.codetoupper,"code39")}},500),e._invoice=function(t){for(var o=0;o<e.billing_list.length;o++)for(var r=0;r<t.length;r++)e.billing_list[o]._id===t[r].transaction_ref&&(e.billing_list[o]._inv=t[r],e.billing_list[o]._invorder=t[r].running)};for(var o=0;o<e.billing_list.length;o++)e.inv.push(e.billing_list[o]._id);p.post_query({invoice:e.inv},e._invoice)}})})}]).controller("PrintReportCustomCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","TransactionApi",function(e,t){e.item_list=[],angular.element(document).ready(function(){t.checkpermission()}),e.items=[{name:"ค่ามัดจำ",price:500},{name:"ค่าประกัน",price:1e4},{name:"คาคีย์การ์ด",price:100},{name:"อินเตอร์เน็ต",price:300},{name:'ทีวี 21"',price:100}]}]).controller("PrintReportBookingCtrl",["$scope","$filter","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","TransactionApi",function(e,t,o,r,i,n,a,c,s,l,p){angular.element(document).ready(function(){o.checkpermission()}),p.get({transaction_id:i.transaction_id},function(r){e.buildingid=r.building_ref._id,o.transaction=r,o.customer=r.customer_ref,o.building=r.building_ref,o.room=r.room_ref,o.property=r.property_ref,e.post=r,e.pricetostring=t("thbToString")(e.post.reserve_price.toString());var i=r.customer_ref._id;i=i.toUpperCase(),e.codetoupper=i,$("#bar_key").barcode(e.codetoupper,"code39");var i=r._id;i=i.toUpperCase(),e.codetoupper=i,$("#bar_key2").barcode(e.codetoupper,"code39")})}]).controller("PrintFurnitureListCtrl",["$scope","$filter","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Adsservice",function(e,t,o,r,i,n,a,c,s){angular.element(document).ready(function(){o.checkpermission()}),s.get({_id:i.apartment_id},function(t){t.$resolved&&(e.property=t)})}]).controller("MakeAgreeMentCtrl",["$scope","$filter","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","TransactionApi","SendNotification",function(e,t,o,r,i,n,a,c,s,l,p){e.post=[],e.post_body={},e.post_body.date=new Date,angular.element(document).ready(function(){o.checkpermission()}),e.insert=function(){e.post_body.agreement_payment_status=e.transaction.agreement_payment_status,e.post_body._id=e.transaction._id,e.post_body.status=0,p.post(e.post_body,function(e){e&&a.path("print_agreement").search("transaction_id="+e._id)})},i.transaction_id?p.get({transaction_id:i.transaction_id},function(r){o.transaction=r,o.accompany=r.accompany,o.customer=r.customer_ref,o.customer.birth_date=o.customer.birth_date?new Date(o.customer.birth_date):"",o.customer.id_card_create=o.customer.id_card_create?new Date(o.customer.id_card_create):"",o.customer.id_card_expiry=o.customer.id_card_expiry?new Date(o.customer.id_card_expiry):"",o.transaction.move_in_date=o.transaction.move_in_date?new Date(o.transaction.move_in_date):"",o.building=r.building_ref,o.transaction.moveout_date=new Date(o.transaction.move_in_date),o.transaction.moveout_date.setYear(o.transaction.moveout_date.getFullYear()+1),o.transaction.moveout_date=new Date(o.transaction.moveout_date),o.room=r.room_ref,o.property=r.property_ref,e.buildingid=r.building_ref._id,e.post=r,e.post_body.coverage=parseInt(o.property.deposit),e.post_body.advance_paid=parseInt(o.room.room_rate)+parseInt(o.room.room_furniture),o.transaction.coverage=parseInt(o.property.deposit),e.pricetostring=t("thbToString")(e.post_body.reserve_price.toString());var i=r._id;i=i.toUpperCase(),e.codetoupper=i,$("#bar_key").barcode(e.codetoupper,"code39")}):i.room_id&&p.get({reserve_id:i.room_id},function(r){o.transaction=r,o.accompany=r.accompany,o.customer=r.customer_ref,o.customer.birth_date=o.customer.birth_date?new Date(o.customer.birth_date):"",o.customer.id_card_create=o.customer.id_card_create?new Date(o.customer.id_card_create):"",o.customer.id_card_expiry=o.customer.id_card_expiry?new Date(o.customer.id_card_expiry):"",o.transaction.move_in_date=o.transaction.move_in_date?new Date(o.transaction.move_in_date):"",o.building=r.building_ref,o.transaction.moveout_date=new Date(o.transaction.move_in_date),o.transaction.moveout_date.setYear(o.transaction.moveout_date.getFullYear()+1),o.transaction.moveout_date=new Date(o.transaction.moveout_date),o.room=r.room_ref,o.property=r.property_ref,e.buildingid=r.building_ref._id,e.post=r,e.post_body.coverage=parseInt(o.property.deposit),e.post_body.advance_paid=parseInt(o.room.room_rate)+parseInt(o.room.room_furniture),o.transaction.coverage=parseInt(o.property.deposit),e.pricetostring=t("thbToString")(e.post_body.reserve_price.toString());var i=r._id;i=i.toUpperCase(),e.codetoupper=i,$("#bar_key").barcode(e.codetoupper,"code39")})}]).controller("MakeAgreeMentReceiptCtrl",["$scope","$filter","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","TransactionApi","SendNotification","CalendarApi",function(e,t,o,r,i,n,a,c,s,l,p,_,d){e.post=[],e.payment_list=[],e.item=[{name:"ค่ามัดจำ",price:500},{name:"ค่าประกัน",price:1e4},{name:"คาคีย์การ์ด",price:100},{name:"อินเตอร์เน็ต",price:300},{name:'ทีวี 21"',price:100}],e.post.payment_this=[],e.post.date=new Date,angular.element(document).ready(function(){o.checkpermission()}),e.$watch("payment_list",function(t){try{e.sum=0;for(var o=0;o<t.length;o++)e.sum+=t[o].payment_this.price*t[o].amount}catch(r){}},!0),e.smsconfirm=0,e.insert=function(){e.post_body={},e.post_body.agreement_payment_status=e.transaction.agreement_payment_status,e.post_body._id=e.transaction._id,e.post_body.payment_list=e.payment_list,p.post(e.post_body,function(t){t&&(e.smsbody={},e.smsbody.email=o.property.contact_email,e.smsbody.tel=o.property.contact_mobile,e.smsbody.message="ได้รับเงินจาก "+o.customer.name+" "+o.customer.last_name+" จำนวน : "+e.sum+" บาท",0==e.smsconfirm&&(e.smsconfirm++,_.post(e.smsbody,function(){})),e.calendar_object={title:"ได้รับเงินจาก "+o.customer.name,textColor:"black",backgroundColor:"#a7ed57",start:Date.now(),user_ref:n.UID},d.post(e.calendar_object,function(){}),p.post(e.post_body,function(e){e&&(a.path("print_agreement").search("transaction_id="+e._id),a.replace())}),l.post({confirm:t.room_ref._id,room_status:2},function(){}),a.path("print_agreement_receipt").search("transaction_id="+t._id))})},void 0!==i.room_id?p.get({room_ref:i.room_id},function(r){o.transaction=r,o.accompany=r.accompany,o.customer=r.customer_ref,o.customer.id_card_create=o.customer.id_card_create?new Date(o.customer.id_card_create):"",o.customer.id_card_expiry=o.customer.id_card_expiry?new Date(o.customer.id_card_expiry):"",o.transaction.move_in_date=o.transaction.move_in_date?new Date(o.transaction.move_in_date):"",o.building=r.building_ref,o.transaction.moveout_date=new Date(o.transaction.moveout_date),o.transaction.move_in_date=new Date(o.transaction.move_in_date),o.room=r.room_ref,o.property=r.property_ref,e.buildingid=r.building_ref._id,e.buildingid=r.building_ref._id,e.post=r,e.transaction.agreement_payment_status=50,e.pricetostring=t("thbToString")(e.post.reserve_price.toString()),e.payment_list=r.payment_list?r.payment_list:e.payment_list,e.roomrate={payment_this:{name:"ค่าห้อง",price:r.room_ref.room_rate},amount:"1"},e.item.push({name:"ค่าห้อง",price:r.room_ref.room_rate}),e.payment_list.unshift(e.roomrate);var i=r._id;i=i.toUpperCase(),e.codetoupper=i,$("#bar_key").barcode(e.codetoupper,"code39")}):i.transaction_id&&p.get({transaction_id:i.transaction_id},function(r){o.transaction=r,o.accompany=r.accompany,o.customer=r.customer_ref,o.customer.id_card_create=o.customer.id_card_create?new Date(o.customer.id_card_create):"",o.customer.id_card_expiry=o.customer.id_card_expiry?new Date(o.customer.id_card_expiry):"",o.transaction.move_in_date=o.transaction.move_in_date?new Date(o.transaction.move_in_date):"",o.building=r.building_ref,o.transaction.moveout_date=new Date(o.transaction.moveout_date),o.transaction.move_in_date=new Date(o.transaction.move_in_date),o.room=r.room_ref,o.property=r.property_ref,e.buildingid=r.building_ref._id,e.buildingid=r.building_ref._id,e.post=r,e.pricetostring=t("thbToString")(e.post.reserve_price.toString()),e.payment_list=r.payment_list?r.payment_list:e.payment_list,e.roomrate={payment_this:{name:"ค่าห้อง",price:r.room_ref.room_rate},amount:"1"},e.item.push({name:"ค่าห้อง",price:r.room_ref.room_rate}),e.payment_list.unshift(e.roomrate);
var i=r._id;i=i.toUpperCase(),e.codetoupper=i,$("#bar_key").barcode(e.codetoupper,"code39")})}]).controller("PrintAgreeMentCtrl",["$scope","$filter","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","TransactionApi",function(e,t,o,r,i,n,a,c,s,l,p){e.post=[],e.post_body={},e.post_body.date=new Date,angular.element(document).ready(function(){o.checkpermission()}),e.insert=function(){p.post({status:1,_id:o.transaction._id},function(){}),l.post({confirm:o.room._id,room_status:2},function(){})},p.get({transaction_id:i.transaction_id},function(t){o.transaction=t,o.accompany=t.accompany,o.customer=t.customer_ref,o.customer.id_card_create=o.customer.id_card_create?new Date(o.customer.id_card_create):"",o.customer.id_card_expiry=o.customer.id_card_expiry?new Date(o.customer.id_card_expiry):"",o.transaction.move_in_date=o.transaction.move_in_date?new Date(o.transaction.move_in_date):"",o.building=t.building_ref,o.transaction.moveout_date=new Date(o.transaction.moveout_date),o.transaction.move_in_date=new Date(o.transaction.move_in_date),o.room=t.room_ref,o.property=t.property_ref,e.buildingid=t.building_ref._id,o.customer.birth_date=new Date(o.customer.birth_date),e.post_body.coverage=t.coverage,e.post_body.advance_paid=t.advance_paid,e.post_body.move_in_date=t.move_in_date,e.post=t;var r=t._id;r=r.toUpperCase(),e.codetoupper=r,$("#bar_key").barcode(e.codetoupper,"code39")})}]).controller("PrintAgreeMentReceiptCtrl",["$scope","$filter","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","TransactionApi",function(e,t,o,r,i,n,a,c,s,l,p){e.post=[],e.post.date=new Date,angular.element(document).ready(function(){o.checkpermission(),e.$watch("payment_list",function(t){try{e.sum=0;for(var o=0;o<t.length;o++)e.sum+=t[o].payment_this.price*t[o].amount}catch(r){}},!0)}),p.get({transaction_id:i.transaction_id},function(t){o.transaction=t,o.accompany=t.accompany,o.customer=t.customer_ref,o.customer.id_card_create=o.customer.id_card_create?new Date(o.customer.id_card_create):"",o.customer.id_card_expiry=o.customer.id_card_expiry?new Date(o.customer.id_card_expiry):"",o.transaction.move_in_date=o.transaction.move_in_date?new Date(o.transaction.move_in_date):"",o.building=t.building_ref,o.transaction.moveout_date=new Date(o.transaction.moveout_date),o.transaction.move_in_date=new Date(o.transaction.move_in_date),o.room=t.room_ref,o.property=t.property_ref,e.buildingid=t.building_ref._id,e.payment_list=[],e.payment_list.push({payment_this:{name:"ค่าประกัน",price:parseInt(t.coverage)},amount:1}),e.payment_list.push({payment_this:{name:"ค่าเช่าล่วงหน้า",price:parseInt(t.advance_paid)},amount:1});var r=t._id;r=r.toUpperCase(),e.codetoupper=r,$("#bar_key").barcode(e.codetoupper,"code39")})}]).controller("PrintReceiptBookingCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","TransactionApi",function(e,t,o,r,i,n,a,c,s,l){angular.element(document).ready(function(){t.checkpermission()}),l.get({receipt:r.transaction_id},function(o){t.customer=o.customer_ref,t.building=o.building_ref,t.room=o.room_ref,t.property=o.property_ref;var r=o.customer_ref._id;r=r.toUpperCase(),e.codetoupper=r,$("#bar_key").barcode(e.codetoupper,"code39");var r=o._id;r=r.toUpperCase(),e.codetoupper=r,$("#bar_key2").barcode(e.codetoupper,"code39"),e.transaction=o,e.transaction.date=new Date(e.transaction.date),e.buildingid=o.building_ref._id})}]).controller("ConfirmReceiptBookingCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Room","TransactionApi","SendNotification",function(e,t,o,r,i,n,a,c,s,l){angular.element(document).ready(function(){t.checkpermission();var o="example1234";o=o.toUpperCase(),e.codetoupper=o,$("#bar_key").barcode(e.codetoupper,"code39"),$("#bar_key2").barcode(e.codetoupper,"code39")}),e.test=e.payment_status,void 0!==r.transaction_id?l.get({transaction_id:r.transaction_id},function(o){t.transaction=o,t.transaction=o,t.customer=o.customer_ref,t.building=o.building_ref,t.room=o.room_ref,t.property=o.property_ref,e.buildingid=o.building_ref._id}):(n.path("index"),n.replace()),e.$watch("transaction.reserve_payment_status",function(t){e.reserve_payment_status=t}),e.savereceipt=function(){e.post_body=t.transaction,delete e.post_body.accompany,e.post_body.property_ref=e.post_body.property_ref._id,e.post_body.customer_ref=e.post_body.customer_ref._id,e.post_body.building_ref=e.post_body.building_ref._id,e.post_body.room_ref=e.post_body.room_ref._id,e.post_body.reserve_payment_status=e.reserve_payment_status,l.post(e.post_body,function(e){e&&(t.transaction=e,t.customer=e.customer_ref,t.building=e.building_ref,t.room=e.room_ref,t.property=e.property_ref,s.post({confirm:e.room_ref._id,room_status:1},function(){}),n.path("print_receipt_booking").search("transaction_id="+e._id),n.replace())})}}]).controller("PropertyCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Adsservice","PropertyApi","CompanyApi",function(e,t,o,r,i,n,a,c,s,l,p){angular.element(document).ready(function(){t.checkpermission()}),e.property_list=[],p.query({property_request:1},function(t){e.property_list=t}),e.remove_property=function(t){var o=confirm("คุณต้องการลบ "+name+" ออกจากระบบ");1==o&&l.remove({_id:t},function(){s.query({user_id:i.UID},function(t){e.property_list=t})})}}]).controller("BuildingCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Adsservice",function(e,t,o,r,i,n,a,c,s){angular.element(document).ready(function(){t.checkpermission()}),e.building={},s.query({user_id:i.UID},function(t){e.property_list=t}),e.addbuilding=function(){e.building.property_ref=e.property._id,e.building.user_ref=i.UID,e.building.user_ref?c.post({building:e.building},function(){c.query({user_ref:i.UID},function(e){t.building_list=e,t.initwaiting=1,n.path("manage_building"),n.replace()})}):alert("กรุณา login หรือ หรือเปิดใช้งาน Cookies หากขัดข้องกรุณาติดต่อเจ้าหน้าที่")}}]).controller("ManageCustomerCtrl",["$scope","$rootScope","$cookies","$routeParams","$location","$anchorScroll","$log","CustomerApi","CompanyApi",function(e,t,o,r,i,n,a,c,s){angular.element(document).ready(function(){t.checkpermission()}),s.get("",function(t){c.query({company_id:t._id},function(t){e.customer_list=t})}),e.del=function(t,o){var r=confirm("คุณต้องการลบ "+o+" ออกจากระบบ");1==r&&c.remove({_id:t},function(){s.get("",function(t){c.query({company_id:t._id},function(t){e.customer_list=t})})})}}]).controller("RoomCtrl",["$scope","$rootScope","$routeParams","$log","$location","$anchorScroll","Room","PropertyApi","ElectApi","WaterApi",function(e,t,o,r,i,n,a,c){angular.element(document).ready(function(){t.checkpermission()}),e.room={},e._id=o.building_id;for(var s=t.building_list.length-1;s>=0;s--)t.building_list[s]._id.toString()===e._id.toString()&&c.get({_id:t.building_list[s].property_ref},function(t){e.room.property_ref=t._id,e.room.room_rate_daily=t.dailyprice,e.room.room_rate=t.price_min});e.addroom=function(){e.room.building_ref=o.building_id,a.post({room:e.room},function(e){e._id?(i.path("/manage_room").search("building_id="+o.building_id),i.replace()):alert("บันทึกไม่สำเร็จ หากต้องการให้ระบบดึงค่าห้องมาตรฐาน กรุณาเพิ่มค่าห้องไปที่ข้อมูลที่พักก่อน")})}}]).controller("ManageSiteCtrl",["$scope","$rootScope","$log","$routeParams","$cookies","$location","$anchorScroll","Building","Adsservice","PropertyApi",function(e,t,o,r,i,n,a,c,s,l){angular.element(document).ready(function(){t.checkpermission()}),s.query({user_id:i.UID},function(t){e.property_list=t}),e.remove_building=function(t){var o=confirm("คุณต้องการลบ "+name+" ออกจากระบบ");1==o&&l.remove({_id:t},function(){s.query({user_id:i.UID},function(t){e.property_list=t})})}}]).controller("ManagebuildingCtrl",["$scope","$routeParams","$rootScope","$log","$cookies","$location","$anchorScroll","Building",function(e,t,o,r,i,n,a,c){angular.element(document).ready(function(){o.checkpermission()}),e.room={},e.remove_building=function(e,t){var r=confirm("คุณต้องการลบตึก "+t);1==r&&c.remove({building_id:e},function(e){alert("ตึก "+e.building+" ถูกลบเรียบร้อยแล้ว"),c.query({user_ref:i.UID},function(e){o.building_list=e,o.initwaiting=1})})}}]).controller("ManageRoomCtrl",["$scope","$routeParams","$rootScope","$log","$location","Room","Building","$anchorScroll","MovingOut","ElectApi","WaterApi",function(e,t,o,r,i,n,a,c,s,l,p){e.post={},e.routeId="test",e.building_id=t.building_id,e.moved_out_check=!1,angular.element(document).ready(function(){o.checkpermission()}),a.get({building_id:t.building_id},function(t){e.building_detail=t}),t.building_id&&(e.buildingid=t.building_id,e.waiting=0,n.query({building_ref:t.building_id},function(t){e.room_list=t,e.waiting=1})),e.select_building=function(e){i.path("manage_room").search("building_id="+e),i.replace()},e.moved_out_toggle=function(t){e.post.room_ref=t,l.query({room_ref:t,limit:2},function(t){e.before_elect=t[0].elect_meter,e.post.elect_meter=t[0].elect_meter}),p.query({room_ref:t,limit:2},function(t){e.before_water=t[0].water_meter,e.post.water_meter=t[0].water_meter}),e.moved_out_check=!e.moved_out_check},e.remove_room=function(o,r){var i=confirm("คุณต้องการลบห้อง "+r);1==i&&n.remove({room_id:o},function(){n.query({building_ref:t.building_id},function(t){e.room_list=t,e.waiting=1})})},e.moved_out=function(){var t=confirm("คุณต้องการย้ายออก ห้อง"+e.post.room_ref.room_no+"ใช่หรือไม่");1==t&&s.post(e.post,function(t){t.$resolved&&"ok"===t.status&&s.post({moving_out:e.post.room_ref},function(e){e&&e.$resolved&&s.get({moved_out:e._id},function(e){e&&e.$resolved&&i.path("/print_report_vat").search("transaction_id="+e._id)})})})},e.moving_out=function(e,t){var o=confirm("คุณต้องการแจ้งย้ายออก ห้อง"+t+"ใช่หรือไม่");1==o&&n.post({confirm:e,room_status:4},function(){})}}]).controller("loginCtrl",["$scope","$rootScope","$routeParams","$location","$anchorScroll","$log","$cookies","Check","Building",function(e,t,o,r,i,n,a,c,s){angular.element(document).ready(function(){t.checkpermission()}),a.UID&&(r.path("/index"),r.replace()),e.login=function(){c.query({username:e.login.username,password:e.login.pass},function(o){void 0!==o.permission?(t.checkpermission(),a.Tel=o.tel,a.Name=o.name,a.UID=o._id,a.Hash=o.password,a.Permission=o.permission,a.Email=o.email,a.Favoriteap=o.favoriteap,t.permissionGlobal=a.Permission,t.username=a.Name,t.idme=a.UID,e.displayCheckBox=!1,s.query({user_ref:a.UID},function(e){t.building_list=e,t.initwaiting=1}),t.checkpermission(),window.open("/manager#!/index","_self")):alert("กรุณาตรวจสอบ ชื่อผู้ใช้หรือรหัสผ่านอีกครั้ง!")})}}]);
;"use strict";angular.module("manage.directives",["ngAnimate","ngSanitize"]).directive("appVersion",function(e){return function(t,r){r.text(e)}}).directive("flowControl",["$http","$cookies",function(e,t){return{restrict:"AEC",scope:{routeId:"=routeid"},templateUrl:"manage/flow_detail.html",link:function(r){var i=t.flowId;e.get("/flow/"+i).success(function(e){r.flow=e,r.next=e.pages[0].next+r.routeId,r.back=e.pages[0].back})}}}]).directive("manageMenu",function(){return{restrict:"AEC",templateUrl:"manage/directive/manage_menu.html"}}).directive("formRoomBooking",function(){return{restrict:"AEC",templateUrl:"manage/directive/form_room_booking.html"}}).directive("formRoomBookingb",function(){return{restrict:"AEC",templateUrl:"manage/directive/form_room_booking2.html"}}).directive("formAddEditChecklist",function(){return{restrict:"AEC",templateUrl:"manage/directive/form_add_edit_checklist.html"}}).directive("formAddEditCoverage",function(){return{restrict:"AEC",templateUrl:"manage/directive/form_add_edit_coverage.html"}}).directive("formReceiptMonthly",function(){return{restrict:"AEC",templateUrl:"manage/directive/form_receipt_monthly.html"}}).directive("formAddEditAccountChartItem",function(){return{restrict:"AEC",templateUrl:"manage/directive/form_add_edit_account_chart_item.html"}}).directive("formAddEditAccountChart",function(){return{restrict:"AEC",templateUrl:"manage/directive/form_add_edit_account_chart.html"}}).directive("customerStep",function(){return{restrict:"AEC",templateUrl:"manage/directive/customer_step.html"}}).directive("formAddPerson",function(){return{restrict:"AEC",templateUrl:"manage/directive/form_add_person.html"}}).directive("formAddEmployee",function(){return{restrict:"AEC",templateUrl:"manage/directive/form_add_employee.html"}}).directive("formAddEditDurable",function(){return{restrict:"AEC",templateUrl:"manage/directive/form_add_edit_durable.html"}}).directive("formAddEditUtility",function(){return{restrict:"AEC",templateUrl:"manage/directive/form_add_edit_utility.html"}}).directive("formReceiptRoomBooking",function(){return{restrict:"AEC",templateUrl:"manage/directive/form_receipt_booking.html"}}).directive("formReceiptAgreemant",function(){return{restrict:"AEC",templateUrl:"manage/directive/form_receipt_agreemant.html"}}).directive("adminChart",function(){return{restrict:"AEC",templateUrl:"manage/directive/adminchart.html"}}).directive("formMakeAgreement",function(){return{restrict:"AEC",templateUrl:"manage/directive/form_make_agreemane.html"}}).directive("formMakeAgreementb",function(){return{restrict:"AEC",templateUrl:"manage/directive/form_make_agreemane2.html"}}).directive("roomColorIndex",function(){return{restrict:"AEC",templateUrl:"manage/directive/room_color_index.html"}}).directive("menuIndex",function(){return{restrict:"AEC",templateUrl:"manage/directive/menu_index.html"}}).directive("formMakeAgreementbEng",function(){return{restrict:"AEC",templateUrl:"manage/directive/form_make_agreemane2_eng.html"}}).directive("manageStatusBar",function(){return{restrict:"AEC",templateUrl:"manage/directive/manage_statusbar.html"}}).directive("autoFocus",["$timeout",function(e){return{restrict:"AC",link:function(t,r){e(function(){r[0].focus()},0)}}}]);
;"use strict";angular.module("manage.filters",[]).filter("interpolate",function(t){return function(n){return String(n).replace(/\%VERSION\%/gm,t)}}).filter("accountsType",function(){return function(t){return t=parseInt(t),1==t?"หมวดสินทรัพย์":2==t?"หมวดหนี้สิน":3==t?"หมวดส่วนของเจ้าของ (ทุน)":4==t?"หมวดรายได้":5==t?"หมวดค่าใช้จ่าย":"-"}}).filter("customerStatus",function(){return function(t){return t=parseInt(t),0==t?"รอดำเนินการ":1==t?"จอง":2==t?"เข้าพัก":"-"}}).filter("invForm",function(){return function(t){try{var n="";n="INV"+t.year+t.month;if(t.running<10)return n+="0000"+t.running;if(t.running<100)return n+="000"+t.running;if(t.running<1e3)return n+="00"+t.running;if(t.running<1e4)return n+="0"+t.running;if(t.running<1e5)return n+=t.running}catch(r){return r}}}).filter("recForm",function(){return function(t){try{var n="";n="REC"+t.year+t.month;if(t.running<10)return n+="0000"+t.running;if(t.running<100)return n+="000"+t.running;if(t.running<1e3)return n+="00"+t.running;if(t.running<1e4)return n+="0"+t.running;if(t.running<1e5)return n+=t.running}catch(r){return r}}}).filter("thDate",function(){return function(t){if(t&&void 0!==t.split("/")[0]){var n=t;n=t.split("/"),n[2]=parseInt(n[2])>2100?parseInt(n[2]):parseInt(n[2])+543,"December"===n[1]?n[1]="ธันวาคม":"November"===n[1]?n[1]="พฤษจิกายน":"October"===n[1]?n[1]="ตุลาคม":"September"===n[1]?n[1]="กันยายน":"August"===n[1]?n[1]="สิงหาคม":"July"===n[1]?n[1]="กรกฎาคม":"June"===n[1]?n[1]="มิถุนายน":"May"===n[1]?n[1]="พฤษภาคม":"April"===n[1]?n[1]="เมษายน":"March"===n[1]?n[1]="มีนาคม":"February"===n[1]?n[1]="กุมภาพันธ์":"January"===n[1]&&(n[1]="มกราคม"),n=n.join(" ")}return n}}).filter("monthDate",function(){return function(t){if(t&&void 0!==t.split("/")[0]){var n=t;n=t.split("/"),n[2]=parseInt(n[2])+543,"December"===n[1]?n[1]="ธันวาคม":"November"===n[1]?n[1]="พฤษจิกายน":"October"===n[1]?n[1]="ตุลาคม":"September"===n[1]?n[1]="กันยายน":"August"===n[1]?n[1]="สิงหาคม":"July"===n[1]?n[1]="กรกฎาคม":"June"===n[1]?n[1]="มิถุนายน":"May"===n[1]?n[1]="พฤษภาคม":"April"===n[1]?n[1]="เมษายน":"March"===n[1]?n[1]="มีนาคม":"Feburary"===n[1]?n[1]="กุมภาพันธ์":"January"===n[1]&&(n[1]="มกราคม")}return n[1]}}).filter("startFrom",function(){return function(t,n){try{return n=+n,t.slice(n)}catch(r){return null}}}).filter("getFirst",function(){return function(t){try{t=t.toString();var n=t.substr(0,1);return n}catch(r){return console.log(r),t}}}).filter("firstUpper",function(){return function(t){try{var n=t.substr(0,1);return n=n.toUpperCase(),n+=t.substr(1,t.length)}catch(r){return console.log(r),t}}}).filter("topupFrom",function(){return function(t){return"02"===t?"บัตรเครดิต":"01"===t?"บัญชีเพย์สบาย":"03"===t?"บัญชีเพย์พาล":"04"===t?"อเมริกัน เอ็กเพรช":"05"===t?"ออนไลน์ ไดเร็กเดบิต":"06"===t?"เงินสด":"-"}}).filter("coverageStatus",function(){return function(t){return 1==t?"-":2==t?"จ่ายแล้ว":"-"}}).filter("roomStatus",function(){return function(t){return t=parseInt(t),0==t?"ว่าง":1==t?"จอง":2==t?"เข้าพัก":3==t?"ค้างชำระ":4==t?"แจ้งย้าย":5==t?"ยกเลิกการจอง":"ห้องว่าง"}}).filter("roomStatusColor",function(){return function(t){return t=parseInt(t),0==t?"#a7ed57":1==t?"#ede165":2==t?"#4b98ed":3==t?"red":4==t?"#b73aff":"ไม่พบสถานะ"}}).filter("transactionType",function(){return function(t){return t=parseInt(t),"0"==t?"รอดำเนินการ":"1"==t?"ใบจอง":"2"==t?"ใบรับเงินจอง":"3"==t?"สัญญาเช่า":"4"==t?"---":"ไม่พบสถานะ"}}).filter("transactionName",function(){return function(t){return 0==t.transaction_type&&0==t.status?"รอดำเนินการ":1==t.transaction_type&&0==t.status?"จองห้องแต่ยังไม่ได้ชำระเงิน":1==t.transaction_type&&1==t.status?"จองและชำระเงินแล้ว":2==t.transaction_type&&1==t.status?"ใบเสร็จ":3==t.transaction_type&&1==t.status?"เข้าพัก":3==t.transaction_type&&2==t.status?"ย้ายออก":4==t.transaction_type&&0==t.status?"ใบแจ้งหนี้ยังไม่ชำระ":4==t.transaction_type&&1==t.status?"ใบแจ้งหนี้ชำระเงินแล้ว":"---"}}).filter("paymentList",function(){return function(t){return"50"==t?"เงินสด":"51"==t?"เช็คธนาคาร":"52"==t?"บัตรเครดิต":"1"==t?"ธนาคารกรุงเทพ":"2"==t?"ธนาคารกรุงศรีอยุธยา":"3"==t?"ธนาคารกสิกรไทย":"4"==t?"ธนาคารทหารไทย":"5"==t?"ธนาคารทิสโก้":"6"==t?"ธนาคารไทยพาณิชย์":"7"==t?"ธนาคารธนชาต":"8"==t?"ธนาคารกรุงไทย":"9"==t?"ธนาคารออมสิน":"10"==t?"ธนาคารอิสลามแห่งประเทศไทย":"11"==t?"ธนาคารไทยเครดิตเพื่อรายย่อย":"12"==t?"ธนาคารยูโอบี":"-"}}).filter("rentType",function(){return function(t){return t=parseInt(t),1==t?"รายวัน":2==t?"รายเดือน":"ไม่พบประเภท"}}).filter("imagefullsize",["$rootScope",function(t){return function(n){return"_"===n.substr(1,1)?t.isMobile?"images/mobile/"+n:"images/desktop/"+n:void 0}}]).filter("imageThumbnail",function(){return function(t){try{return"1_"===t.substr(0,2)?"images/thumbnail/"+t:t}catch(n){}}}).filter("thbToString",function(){return function(t){var n=parseFloat(t).toFixed(2),r="";if(-1!==n.search(/\./)){var e=n.split(".");n=e[0];for(var i=0;i<=n.length-1;i++)"0"!==n[i]&&"2"!==n[i]&&"1"!==n[i]?(r+=thbtotext(n[i]),r+=thbpostfix(n.length-1-i)):"1"===n[i]&&n.length-1-i==1?r+="สิบ":"2"===n[i]&&n.length-1-i==1?r+="ยี่สิบ":"1"===n[i]&&n.length-1-i==0?r+="เอ็ดบาท":"2"===n[i]&&n.length-1-i!==1?(r+=thbtotext(n[i]),r+=thbpostfix(n.length-1-i)):"1"===n[i]&&n.length-1-i!==0?(r+=thbtotext(n[i]),r+=thbpostfix(n.length-1-i)):"0"===n[i]&&n.length-1-i===0&&(r+=thbpostfix(n.length-1-i));n=e[1];for(var i=0;i<=n.length-1;i++)"0"!==n[i]&&"2"!==n[i]&&"1"!==n[i]?(r+=thbtotext(n[i]),r+=thbpostfixpoint(n.length-1-i)):"1"===n[i]&&n.length-1-i==1?r+="สิบ":"2"===n[i]&&n.length-1-i==1?r+="ยี่สิบ":"1"===n[i]&&n.length-1-i==0?r+="เอ็ดสตางค์":"2"===n[i]&&n.length-1-i!==1?(r+=thbtotext(n[i]),r+=thbpostfixpoint(n.length-1-i)):"1"===n[i]&&n.length-1-i!==0?(r+=thbtotext(n[i]),r+=thbpostfixpoint(n.length-1-i)):"0"===n[i]&&n.length-1-i==0&&(r+=thbpostfixpoint(n.length-1-i));return"00"===n?r=r.replace("สตางค์"," "):r}for(var i=0;i<=n.length-1;i++)"0"!==n[i]&&"2"!==n[i]&&"1"!==n[i]?(r+=thbtotext(n[i]),r+=thbpostfix(n.length-1-i)):"1"===n[i]&&n.length-1-i==1?r+="สิบ":"2"===n[i]&&n.length-1-i==1?r+="ยี่สิบ":"1"===n[i]&&n.length-1-i==0?r+="เอ็ดบาท":"2"===n[i]&&n.length-1-i!==1?(r+=thbtotext(n[i]),r+=thbpostfix(n.length-1-i)):"1"===n[i]&&n.length-1-i!==0?(r+=thbtotext(n[i]),r+=thbpostfix(n.length-1-i)):"0"===n[i]&&n.length-1-i==0&&(r+=thbpostfix(n.length-1-i));return r}});var thbpostfix=function(t){return 6==t?"ล้าน":5==t?"แสน":4==t?"หมื่น":3==t?"พัน":2==t?"ร้อย":1==t?"สิบ":0==t?"บาท":void 0},thbpostfixpoint=function(t){return 6==t?"ล้าน":5==t?"แสน":4==t?"หมื่น":3==t?"พัน":2==t?"ร้อย":1==t?"สิบ":0==t?"สตางค์":void 0},thbtotext=function(t){return"1"===t?"หนึ่ง":"2"===t?"สอง":"3"===t?"สาม":"4"===t?"สี่":"5"===t?"ห้า":"6"===t?"หก":"7"===t?"เจ็ด":"8"===t?"แปด":"9"===t?"เก้า":"0"===t?"":void 0};
;"use strict";angular.module("manage.services",["ngResource"]).value("version","0.1").factory("Place",["$resource",function(r){return r("https://maps.googleapis.com/maps/api/place/nearbysearch/json",{location:"",radius:500,types:"",key:"AIzaSyDnACcjGRPA_KhojEjtgHAzWBY9WsIW_rI"},{query:{method:"GET",params:{location:"",radius:500,types:"",key:"AIzaSyDnACcjGRPA_KhojEjtgHAzWBY9WsIW_rI"},isArray:!1}})}]).factory("SummaryBill",["$resource",function(r){return r("/summarybill",{},{put:{method:"POST",params:{},isArray:!1},post:{method:"POST",params:{},isArray:!1},get:{method:"GET",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},remove:{method:"DELETE",params:{},isArray:!1}})}]).factory("Menu",["$resource",function(r){return r("/menu",{},{get:{method:"GET",params:{},isArray:!1}})}]).factory("Note",["$resource",function(r){return r("/noteapi",{},{get:{method:"GET",params:{},isArray:!1},post:{method:"POST",params:{},isArray:!1}})}]).factory("TransactionItem",["$resource",function(r){return r("/transactionitem",{},{post:{method:"POST",params:{},isArray:!1}})}]).factory("InvoiceApi",["$resource",function(r){return r("/invoice_api",{},{put:{method:"POST",params:{},isArray:!1},post:{method:"POST",params:{},isArray:!1},post_array:{method:"POST",params:{},isArray:!0},post_query:{method:"POST",params:{},isArray:!0},get:{method:"GET",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},remove:{method:"DELETE",params:{},isArray:!1}})}]).factory("Accounts",["$resource",function(r){return r("/accounts",{},{put:{method:"POST",params:{},isArray:!1},post:{method:"POST",params:{},isArray:!1},post_query:{method:"POST",params:{},isArray:!0},get:{method:"GET",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},remove:{method:"DELETE",params:{},isArray:!1}})}]).factory("MovingOut",["$resource",function(r){return r("/moveout",{},{put:{method:"POST",params:{},isArray:!1},post:{method:"POST",params:{},isArray:!1},post_query:{method:"POST",params:{},isArray:!0},get:{method:"GET",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},remove:{method:"DELETE",params:{},isArray:!1}})}]).factory("ExpendApi",["$resource",function(r){return r("/expendapi",{},{put:{method:"POST",params:{},isArray:!1},post:{method:"POST",params:{},isArray:!1},post_query:{method:"POST",params:{},isArray:!0},get:{method:"GET",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},remove:{method:"DELETE",params:{},isArray:!1}})}]).factory("CompanyApi",["$resource",function(r){return r("/company_api",{},{put:{method:"PUT",params:{},isArray:!1},post:{method:"POST",params:{},isArray:!1},post_query:{method:"POST",params:{},isArray:!0},get:{method:"GET",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},remove:{method:"DELETE",params:{},isArray:!1}})}]).factory("EmployeeApi",["$resource",function(r){return r("/employeeapi",{},{put:{method:"POST",params:{},isArray:!1},post:{method:"POST",params:{},isArray:!1},post_query:{method:"POST",params:{},isArray:!0},get:{method:"GET",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},remove:{method:"DELETE",params:{},isArray:!1}})}]).factory("ReceiptApi",["$resource",function(r){return r("/receipt_api",{},{put:{method:"POST",params:{},isArray:!1},post:{method:"POST",params:{},isArray:!1},post_query:{method:"POST",params:{},isArray:!0},get:{method:"GET",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},remove:{method:"DELETE",params:{},isArray:!1}})}]).factory("SponsorApartment",["$resource",function(r){return r("/listsponsor",{},{get:{method:"GET",params:{},isArray:!0}})}]).factory("ResetDemo",["$resource",function(r){return r("/demo_reset",{},{post:{method:"POST",params:{},isArray:!1}})}]).factory("Zipcode",["$resource",function(r){return r("/getzipcode",{},{get:{method:"GET",params:{},isArray:!1}})}]).factory("Board",["$resource",function(r){return r("/createtopic",{},{create:{method:"POST",params:{feedback:{}},isArray:!1},feed:{method:"GET",params:{},isArray:!1},comment:{method:"POST",params:{comments:{}},isArray:!1}})}]).factory("GotoInfo",["$resource",function(r){return r("/adscountclick",{},{post:{method:"POST",param:{_id:{}},isArray:!1}})}]).factory("Myads",["$resource",function(r){return r("/myads",{},{query:{method:"GET",params:{},isArray:!0}})}]).factory("Adsstatus",["$resource",function(r){return r("/adsstatus",{},{query:{method:"GET",param:{},isArray:!1},post:{method:"POST",params:{set:{}},isArray:!1}})}]).factory("Adscreation",["$resource",function(r){return r("/adsmanage",{},{post:{method:"POST",params:{cus_regis:{}},isArray:!1}})}]).factory("PasswordChange",["$resource",function(r){return r("/forget",{},{post:{method:"POST",params:{reset:{}},isArray:!1},query:{method:"GET",params:{reset:{}},isArray:!1}})}]).factory("Permission",["$resource",function(r){return r("/permission",{},{post:{method:"POST",params:{permis:{}},isArray:!1},query:{method:"GET",params:{},isArray:!0}})}]).factory("Userlist",["$resource",function(r){return r("/listUser",{},{query:{method:"GET",params:{},isArray:!0}})}]).factory("Building",["$resource",function(r){return r("/building",{},{put:{method:"POST",params:{building:{}},isArray:!1},post:{method:"POST",params:{building:{}},isArray:!1},get:{method:"GET",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},remove:{method:"DELETE",params:{},isArray:!1}})}]).factory("Room",["$resource",function(r){return r("/roomapi",{},{post:{method:"POST",params:{room:{}},isArray:!1},get:{method:"GET",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},remove:{method:"DELETE",params:{},isArray:!1}})}]).factory("Adsservice",["$resource",function(r){return r("/myproperties",{},{query:{method:"GET",params:{},isArray:!0},get:{method:"GET",params:{},isArray:!1}})}]).factory("Check",["$resource",function(r){return r("/checklogin",{},{query:{method:"GET",params:{username:[],password:[]},isArray:!1}})}]).factory("Uploadprofilepic",["$resource",function(r){return r("/uploadprofilepic",{},{upload:{method:"POST",param:{activecode:{}},isArray:!1}})}]).factory("Active",["$resource",function(r){return r("/login_activeuser",{},{query:{method:"GET",params:{},isArray:!1},active:{method:"POST",param:{activecode:{}},isArray:!1}})}]).factory("ElectApi",["$resource",function(r){return r("/electapi",{},{get:{method:"GET",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},post:{method:"POST",params:{},isArray:!1},remove:{method:"DELETE",params:{},isArray:!1}})}]).factory("PhoneApi",["$resource",function(r){return r("/phoneapi",{},{get:{method:"GET",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},post:{method:"POST",params:{},isArray:!1},remove:{method:"DELETE",params:{},isArray:!1}})}]).factory("SendNotification",["$resource",function(r){return r("/sendnotification",{},{get:{method:"GET",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},post:{method:"POST",params:{},isArray:!1},remove:{method:"DELETE",params:{},isArray:!1}})}]).factory("TransactionApi",["$resource",function(r){return r("/transactionapi",{},{get:{method:"GET",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},post:{method:"POST",params:{},isArray:!1},remove:{method:"DELETE",params:{},isArray:!1}})}]).factory("WaterApi",["$resource",function(r){return r("/waterapi",{},{get:{method:"GET",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},post:{method:"POST",params:{},isArray:!1},remove:{method:"DELETE",params:{},isArray:!1}})}]).factory("ServerTime",["$resource",function(r){return r("/server_time",{},{get:{method:"GET",params:{},isArray:!1}})}]).factory("PropertyApi",["$resource",function(r){return r("/propertiesapi",{},{get:{method:"GET",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},post:{method:"POST",params:{},isArray:!1},remove:{method:"DELETE",params:{},isArray:!1}})}]).factory("CalendarApi",["$resource",function(r){return r("/calendarapi",{},{get:{method:"GET",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},post:{method:"POST",params:{},isArray:!1},remove:{method:"DELETE",params:{},isArray:!1}})}]).factory("InventoryApi",["$resource",function(r){return r("/inventoryapi",{},{get:{method:"GET",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},post:{method:"POST",params:{},isArray:!1},remove:{method:"DELETE",params:{},isArray:!1}})}]).factory("UtilityApi",["$resource",function(r){return r("/utilityapi",{},{get:{method:"GET",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},post:{method:"POST",params:{},isArray:!1},remove:{method:"DELETE",params:{},isArray:!1}})}]).factory("CustomerApi",["$resource",function(r){return r("/customerapi",{},{get:{method:"GET",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},post:{method:"POST",params:{},isArray:!1},remove:{method:"DELETE",params:{},isArray:!1}})}]).factory("Property",["$resource",function(r){return r("/properties",{},{query:{method:"GET",params:{location:[]},isArray:!0}})}]).factory("Duplicate",["$resource",function(r){return r("/checkduplicate",{},{query:{method:"GET",params:{},isArray:!1}})}]).factory("CreateProperty",["$resource",function(r){return r("/createproperty",{},{post:{method:"POST",params:{property:{}},isArray:!1},query:{method:"GET",params:{_id:[]},isArray:!1}})}]).factory("Propertys",["$resource",function(r){return r("/propertiesalone",{},{post:{method:"POST",params:{prop:{}},isArray:!1},query:{method:"GET",params:{_id:[]},isArray:!1}})}]).factory("Filtermain",["$resource",function(r){return r("/propertyInfos",{},{query:{method:"GET",params:{},isArray:!0}})}]).factory("Filter",["$resource",function(r){return r("/getfilter",{},{post:{method:"POST",params:{prop:{}},isArray:!1},query:{method:"GET",params:{},isArray:!1}})}]).factory("Info",["$resource",function(r){return r("/propertyInfo",{},{query:{method:"GET",params:{},isArray:!1},kill:{method:"DELETE",params:{},isArray:!1}})}]).factory("Search",["$resource",function(r){return r("/search",{},{post:{method:"POST",params:{search:{}},isArray:!0},query:{method:"GET",params:{},isArray:!0}})}]).factory("Member",["$resource",function(r){return r("/login_resendemail",{},{query:{method:"GET",params:{reg:{}},isArray:!1},post:{method:"post",params:{upgrade:{}},isArray:!1}})}]).factory("User",["$resource",function(r){return r("/login",{},{post:{method:"POST",params:{reg:{}},isArray:!1},query:{method:"GET",params:{},isArray:!1}})}]).factory("List",["$resource",function(r){return r("/somelist",{},{query:{method:"GET",params:{},isArray:!1}})}]).factory("socket",function(r){return r({ioSocket:io.connect("/")})}).factory("Customer",["$resource",function(r){return r("/customer",{customerId:""},{get:{method:"GET",params:{customerId:""},isArray:!1}})}]).factory("CustomerProperty",["$resource",function(r){return r("/customerproperties/:customerId",{customerId:""},{get:{method:"GET",params:{customerId:""},isArray:!0}})}]).factory("CustomerPropertyOwner",["$resource",function(r){return r("/customerowner",{customerId:""},{get:{method:"GET",params:{customerId:""},isArray:!1}})}]).factory("Sponsor",["$resource",function(r){return r("/sponsor",{},{get:{method:"GET",params:{},isArray:!0}})}]).factory("Paypal",["$resource",function(r){return r("/paypal",{},{get:{method:"GET",params:{},isArray:!0}})}]).factory("Userpayment",["$resource",function(r){return r("/userpayment",{},{query:{method:"GET",params:{},isArray:!0}})}]).factory("CreateTransaction",["$resource",function(r){return r("/createtransaction",{},{post:{method:"POST",params:{},isArray:!1},query:{method:"GET",params:{},isArray:!0},get:{method:"GET",params:{},isArray:!1}})}]).factory("Paysbuy",["$resource",function(r){return r("https://www.paysbuy.com/paynow.aspx",{},{post:{method:"POST",params:{},isArray:!1}})}]).factory("Updatenotice",["$resource",function(r){return r("/noticeupdatedata",{},{post:{method:"POST",params:{},isArray:!1}})}]).factory("Favoritproperty",["$resource",function(r){return r("/favoritproperty",{},{get:{method:"GET",params:{},isArray:!0}})}]).factory("Notificationowner",["$resource",function(r){return r("/notificationcount",{},{get:{method:"GET",params:{},isArray:!1}})}]).factory("Favoritboard",["$resource",function(r){return r("/favoritboard",{},{get:{method:"GET",params:{},isArray:!0}})}]).factory("Contactmail",["$resource",function(r){return r("/mailcontact",{},{post:{method:"POST",params:{},isArray:!1}})}]).factory("salelist",["$resource",function(r){return r("/salelist",{},{get:{method:"GET",params:{},isArray:!0}})}]).factory("Favorite",["$resource",function(r){return r("/favorite",{},{get:{method:"GET",params:{user_id:""},isArray:!0},owerget:{method:"GET",params:{owner_id:""},isArray:!0},post:{method:"POST",params:{},isArray:!1},kill:{method:"DELETE",params:{},isArray:!1}})}]);
//# sourceMappingURL=controllers-dist.js.map